<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 5 Malla de validación | Bookdown Dirección y Análisis</title>
  <meta name="description" content=" 5 Malla de validación | Bookdown Dirección y Análisis" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content=" 5 Malla de validación | Bookdown Dirección y Análisis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 5 Malla de validación | Bookdown Dirección y Análisis" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="clasificación-por-nivel-socio-económico-metodología-aim.html"/>
<link rel="next" href="construcción-de-ponderadores-por-raking.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.21/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bookdown Datavoz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#cómo-aportar-al-bookdown"><i class="fa fa-check"></i><b>1.1</b> ¿Cómo aportar al bookdown?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html"><i class="fa fa-check"></i><b>2</b> Procesamiento de Base de Datos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-de-utilidad-general"><i class="fa fa-check"></i><b>2.1</b> Operadores de utilidad general</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-relacionales"><i class="fa fa-check"></i><b>2.1.1</b> <strong>1. Operadores relacionales</strong></a></li>
<li class="chapter" data-level="2.1.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-aritméticos"><i class="fa fa-check"></i><b>2.1.2</b> <strong>2. Operadores aritméticos</strong></a></li>
<li class="chapter" data-level="2.1.3" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-de-asignación"><i class="fa fa-check"></i><b>2.1.3</b> <strong>3. Operadores de asignación</strong></a></li>
<li class="chapter" data-level="2.1.4" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-booleanos"><i class="fa fa-check"></i><b>2.1.4</b> <strong>4. Operadores booleanos</strong></a></li>
<li class="chapter" data-level="2.1.5" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operador-pipeline"><i class="fa fa-check"></i><b>2.1.5</b> <strong>5. Operador pipeline (%&gt;%)</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#manipulación-de-estructutura-de-bases-de-datos"><i class="fa fa-check"></i><b>2.2</b> Manipulación de estructutura de bases de datos</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tipos-de-variables"><i class="fa fa-check"></i><b>2.2.1</b> Tipos de variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#coerción-explícita"><i class="fa fa-check"></i><b>2.2.2</b> Coerción explícita</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#crear-nuevas-variables"><i class="fa fa-check"></i><b>2.3</b> Crear nuevas variables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#r-base"><i class="fa fa-check"></i><b>2.3.1</b> <strong>1. R Base</strong></a></li>
<li class="chapter" data-level="2.3.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse"><i class="fa fa-check"></i><b>2.3.2</b> <strong>2. Tidyverse</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#limpiar-y-renombrar-variables"><i class="fa fa-check"></i><b>2.4</b> Limpiar y renombrar variables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#limpiar-nombre-de-variables-librería-janitor"><i class="fa fa-check"></i><b>2.4.1</b> <strong>1. Limpiar nombre de variables, librería “janitor”</strong></a></li>
<li class="chapter" data-level="2.4.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#renombrar-variables"><i class="fa fa-check"></i><b>2.4.2</b> <strong>2. Renombrar variables</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#reordenar-variables"><i class="fa fa-check"></i><b>2.5</b> Reordenar variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#r-base-2"><i class="fa fa-check"></i><b>2.5.1</b> <strong>1. R base</strong></a></li>
<li class="chapter" data-level="2.5.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse-2"><i class="fa fa-check"></i><b>2.5.2</b> <strong>2. Tidyverse</strong></a></li>
<li class="chapter" data-level="2.5.3" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#función-personalizada"><i class="fa fa-check"></i><b>2.5.3</b> <strong>3. Función personalizada</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#recodificación-de-variables"><i class="fa fa-check"></i><b>2.6</b> Recodificación de variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#r-base-3"><i class="fa fa-check"></i><b>2.6.1</b> <strong>1. R base</strong></a></li>
<li class="chapter" data-level="2.6.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse-3"><i class="fa fa-check"></i><b>2.6.2</b> <strong>2. Tidyverse</strong></a></li>
<li class="chapter" data-level="2.6.3" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#car"><i class="fa fa-check"></i><b>2.6.3</b> <strong>3. Car</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#selección-de-variables"><i class="fa fa-check"></i><b>2.7</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#r-base-4"><i class="fa fa-check"></i><b>2.7.1</b> <strong>R Base</strong></a></li>
<li class="chapter" data-level="2.7.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse-4"><i class="fa fa-check"></i><b>2.7.2</b> <strong>Tidyverse</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#filtrar-casos"><i class="fa fa-check"></i><b>2.8</b> Filtrar casos</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse-5"><i class="fa fa-check"></i><b>2.8.1</b> <strong>Tidyverse</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#bases-de-datos-long-y-wide"><i class="fa fa-check"></i><b>2.9</b> Bases de datos Long y Wide</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#de-long-a-wider"><i class="fa fa-check"></i><b>2.9.1</b> <strong>1. De long a wider</strong></a></li>
<li class="chapter" data-level="2.9.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#de-wider-a-long"><i class="fa fa-check"></i><b>2.9.2</b> <strong>2. De wider a long</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#colapsar-variables"><i class="fa fa-check"></i><b>2.10</b> Colapsar variables</a></li>
<li class="chapter" data-level="2.11" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#for-loops"><i class="fa fa-check"></i><b>2.11</b> For loops</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><i class="fa fa-check"></i><b>3</b> Automatización de tabulaciones de variables (de frecuencia, contingencia y diferencia de medias)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#tablas-de-frecuenciacontingencia"><i class="fa fa-check"></i><b>3.1</b> Tablas de frecuencia/contingencia</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cargar-nuestra-bbdd"><i class="fa fa-check"></i><b>3.1.1</b> <strong>1. Cargar nuestra BBDD</strong></a></li>
<li class="chapter" data-level="3.1.2" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creamos-un-banner"><i class="fa fa-check"></i><b>3.1.2</b> <strong>2. Creamos un banner</strong></a></li>
<li class="chapter" data-level="3.1.3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#una-vez-creamos-nuestro-objeto-banner-debemos-crear-una-función-capaz-de-crear-las-diferencias-proporcionales"><i class="fa fa-check"></i><b>3.1.3</b> <strong>3. Una vez creamos nuestro objeto banner, debemos crear una función capaz de crear las diferencias proporcionales</strong></a></li>
<li class="chapter" data-level="3.1.4" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creación-de-secciones-recomendado"><i class="fa fa-check"></i><b>3.1.4</b> <strong>4. Creación de secciones (Recomendado)</strong></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#tablas-de-diferencias-de-medias"><i class="fa fa-check"></i><b>3.2</b> Tablas de diferencias de medias</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creamos-un-banner-1"><i class="fa fa-check"></i><b>3.2.1</b> <strong>1. Creamos un banner</strong></a></li>
<li class="chapter" data-level="3.2.2" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creamos-una-función-que-nos-permita-calcular-las-diferencias-de-medias"><i class="fa fa-check"></i><b>3.2.2</b> <strong>2. Creamos una función que nos permita calcular las diferencias de medias</strong></a></li>
<li class="chapter" data-level="3.2.3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creación-de-secciones-recomendado-1"><i class="fa fa-check"></i><b>3.2.3</b> <strong>3. Creación de secciones (Recomendado)</strong></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#exportar-tablas-a-excel"><i class="fa fa-check"></i><b>3.3</b> Exportar tablas a excel</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#independientes-porcentajes"><i class="fa fa-check"></i><b>3.3.1</b> 1. Independientes: porcentajes</a></li>
<li class="chapter" data-level="3.3.2" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#independientes-diferencia-de-medias"><i class="fa fa-check"></i><b>3.3.2</b> 2. Independientes: diferencia de medias</a></li>
<li class="chapter" data-level="3.3.3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#en-conjunto-porcentaje-y-dif-de-medias-en-un-solo-archivo"><i class="fa fa-check"></i><b>3.3.3</b> 3. En conjunto: porcentaje y dif de medias en un solo archivo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html"><i class="fa fa-check"></i><b>4</b> Clasificación por nivel socio-económico (Metodología AIM)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#construcción-con-ingreso"><i class="fa fa-check"></i><b>4.1</b> Construcción con ingreso</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#a.-cargar-nuestros-datos"><i class="fa fa-check"></i><b>4.1.1</b> <strong>a. cargar nuestros datos</strong></a></li>
<li class="chapter" data-level="4.1.2" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#b.-recodificar-nuestras-variables"><i class="fa fa-check"></i><b>4.1.2</b> <strong>b. recodificar nuestras variables</strong></a></li>
<li class="chapter" data-level="4.1.3" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#c.-integrar-la-variable-gse-y-generar-recodificación"><i class="fa fa-check"></i><b>4.1.3</b> <strong>c. integrar la variable gse y generar recodificación</strong></a></li>
<li class="chapter" data-level="4.1.4" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#d-exportar-bbdd-con-clasificación-socioeconómica"><i class="fa fa-check"></i><b>4.1.4</b> **d) exportar BBDD con clasificación socioeconómica</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#construcción-sin-ingreso-proxy"><i class="fa fa-check"></i><b>4.2</b> Construcción sin ingreso (proxy)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#a.-cargar-nuestros-datos-1"><i class="fa fa-check"></i><b>4.2.1</b> <strong>a. Cargar nuestros datos</strong></a></li>
<li class="chapter" data-level="4.2.2" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#b.-recodificar-nuestras-variables-1"><i class="fa fa-check"></i><b>4.2.2</b> <strong>b. recodificar nuestras variables</strong></a></li>
<li class="chapter" data-level="4.2.3" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#c.-integrar-la-variable-gse-y-generar-recodificación-1"><i class="fa fa-check"></i><b>4.2.3</b> <strong>c. integrar la variable gse y generar recodificación</strong></a></li>
<li class="chapter" data-level="4.2.4" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#d.-exportar-bbdd-con-clasificación-socioeconómica"><i class="fa fa-check"></i><b>4.2.4</b> <strong>d. exportar BBDD con clasificación socioeconómica</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="malla-de-validación.html"><a href="malla-de-validación.html"><i class="fa fa-check"></i><b>5</b> Malla de validación</a>
<ul>
<li class="chapter" data-level="5.1" data-path="malla-de-validación.html"><a href="malla-de-validación.html#errores-de-valores-perdidos"><i class="fa fa-check"></i><b>5.1</b> Errores de valores perdidos</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="malla-de-validación.html"><a href="malla-de-validación.html#a-selección-de-id-y-variables-de-interés"><i class="fa fa-check"></i><b>5.1.1</b> a) selección de Id y variables de interés</a></li>
<li class="chapter" data-level="5.1.2" data-path="malla-de-validación.html"><a href="malla-de-validación.html#b-casos-perdidos-por-fila-y-columnas"><i class="fa fa-check"></i><b>5.1.2</b> b) casos perdidos por fila y columnas</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="malla-de-validación.html"><a href="malla-de-validación.html#errores-de-programación"><i class="fa fa-check"></i><b>5.2</b> Errores de programación</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="malla-de-validación.html"><a href="malla-de-validación.html#a-creación-de-excel-y-criterios-de-salto"><i class="fa fa-check"></i><b>5.2.1</b> a) creación de excel y criterios de salto</a></li>
<li class="chapter" data-level="5.2.2" data-path="malla-de-validación.html"><a href="malla-de-validación.html#b-aplicación-del-loop"><i class="fa fa-check"></i><b>5.2.2</b> b) aplicación del loop</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="malla-de-validación.html"><a href="malla-de-validación.html#errores-de-consistencia"><i class="fa fa-check"></i><b>5.3</b> Errores de consistencia</a></li>
<li class="chapter" data-level="5.4" data-path="malla-de-validación.html"><a href="malla-de-validación.html#errores-de-rango"><i class="fa fa-check"></i><b>5.4</b> Errores de rango</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="malla-de-validación.html"><a href="malla-de-validación.html#a-creación-de-excel-y-criterios-de-rango"><i class="fa fa-check"></i><b>5.4.1</b> a) creación de excel y criterios de rango</a></li>
<li class="chapter" data-level="5.4.2" data-path="malla-de-validación.html"><a href="malla-de-validación.html#b-aplicación-del-loop-1"><i class="fa fa-check"></i><b>5.4.2</b> b) aplicación del loop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html"><i class="fa fa-check"></i><b>6</b> Construcción de ponderadores por Raking</a>
<ul>
<li class="chapter" data-level="6.1" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#cargar-bases-de-datos-necesarias"><i class="fa fa-check"></i><b>6.1</b> Cargar bases de datos necesarias</a></li>
<li class="chapter" data-level="6.2" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#chequeo-de-variables"><i class="fa fa-check"></i><b>6.2</b> Chequeo de variables</a></li>
<li class="chapter" data-level="6.3" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#recodificaciones"><i class="fa fa-check"></i><b>6.3</b> Recodificaciones</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#recodificación-de-variables-en-bbdd-de-estudio"><i class="fa fa-check"></i><b>6.3.1</b> Recodificación de variables en BBDD de estudio</a></li>
<li class="chapter" data-level="6.3.2" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#recodificaciones-en-bbdd-de-proyecciones-pobalcionales"><i class="fa fa-check"></i><b>6.3.2</b> Recodificaciones en BBDD de proyecciones pobalcionales</a></li>
<li class="chapter" data-level="6.3.3" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#proyecciones-poblacionales-mayores-a-18-años"><i class="fa fa-check"></i><b>6.3.3</b> Proyecciones poblacionales mayores a 18 años</a></li>
<li class="chapter" data-level="6.3.4" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#recodificación-bbdd-casen-2020"><i class="fa fa-check"></i><b>6.3.4</b> Recodificación BBDD Casen 2020</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#construcción-del-ponderador"><i class="fa fa-check"></i><b>6.4</b> Construcción del ponderador</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#creación-de-un-objeto-sin-pesos"><i class="fa fa-check"></i><b>6.4.1</b> <em>Creación de un objeto sin pesos</em></a></li>
<li class="chapter" data-level="6.4.2" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#crear-las-distribuciones-marginales-poblacionales-de-cada-variable-a-utilizar-para-ponderar"><i class="fa fa-check"></i><b>6.4.2</b> <em>Crear las distribuciones marginales poblacionales de cada variable a utilizar para ponderar</em></a></li>
<li class="chapter" data-level="6.4.3" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#cáluclo-del-ponderador"><i class="fa fa-check"></i><b>6.4.3</b> <em>Cáluclo del ponderador</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html"><a href="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html"><i class="fa fa-check"></i><b>7</b> Introducción a RMarkdown y creación de reportes automáticos</a>
<ul>
<li class="chapter" data-level="7.1" data-path="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html"><a href="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html#qué-es-rmarkdown-rmd"><i class="fa fa-check"></i><b>7.1</b> ¿Qué es RMarkdown (RMD)?</a></li>
<li class="chapter" data-level="7.2" data-path="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html"><a href="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html#sintaxis-básica-de-escritura"><i class="fa fa-check"></i><b>7.2</b> Sintaxis básica de escritura</a></li>
<li class="chapter" data-level="7.3" data-path="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html"><a href="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html#creación-y-opciones-los-chunks"><i class="fa fa-check"></i><b>7.3</b> Creación y opciones los chunks</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html"><a href="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html#opciones-de-los-chunks"><i class="fa fa-check"></i><b>7.3.1</b> Opciones de los chunks:</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html"><a href="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html#reportes-automáticos"><i class="fa fa-check"></i><b>7.4</b> Reportes automáticos</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html"><a href="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html#reporte-encuestas-presenciales"><i class="fa fa-check"></i><b>7.4.1</b> Reporte encuestas presenciales</a></li>
<li class="chapter" data-level="7.4.2" data-path="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html"><a href="introducción-a-rmarkdown-y-creación-de-reportes-automáticos.html#reporte-encuestas-telefónicas"><i class="fa fa-check"></i><b>7.4.2</b> Reporte encuestas telefónicas</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bookdown Dirección y Análisis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="malla-de-validación" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number"> 5</span> Malla de validación<a href="malla-de-validación.html#malla-de-validación" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Una malla de validación permite revisar de manera automática la consistencia de la información proveniente de cada encuesta y los rangos de las respuestas, identificando de manera automática cuando un valor o respuesta específica no corresponda a un rango, previamente determinado, o cuando una respuesta sea inconsistente en relación a respuestas anteriores, según los saltos específicos de cada instrumento.</p>
<p>Veremos como programar los siguientes tipos de errores:</p>
<ol style="list-style-type: lower-roman">
<li><p>errores de valores perdidos, asociados a preguntas de respuesta obligatoria que se encuentren sin respuestas (missing);</p></li>
<li><p>errores de programación, como saltos o filtros mal aplicados o preguntas de respuesta múltiples que carezcan de respuesta en al menos una opción;</p></li>
<li><p>errores de consistencia, como datos fuera de rangos o extremos (datos que se escapan de los rangos, Ej: Edad.), y detectar inconsistencias lógicas en las respuestas de los participantes.</p></li>
</ol>
<p><strong>Data a utilizar</strong></p>
<p>Para el ejercicio, se utilizará la base de datos de la Encuesta Nacional de Uso del Tiempo (ENUT) 2015.</p>
<p>Se utilizarán dos versiones de dicha BBDD: una corregida tal como se puede descargar desde la pagina web del Instituto Nacional de Estadísticas y una alterada, en la que se introdujeron errores a propósito para ilustrar el funcionamiento de la malla de validación.</p>
<p><strong>Comenzaremos trabajando con la BBDD original</strong></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="malla-de-validación.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb134-2"><a href="malla-de-validación.html#cb134-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;BBDD/BASE_USUARIO_corregida.sav&quot;</span>)</span></code></pre></div>
<p>Para descargar los datos hacer click en:</p>
<p><a href="https://github.com/Jona-S99/Bookdown/raw/master/BBDD/BASE_USUARIO_corregida.sav">Base corregida</a></p>
<p><a href="https://github.com/Jona-S99/Bookdown/raw/master/BBDD/BASE_USUARIO_alterada.sav">Base alterada</a></p>
<div id="errores-de-valores-perdidos" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Errores de valores perdidos<a href="malla-de-validación.html#errores-de-valores-perdidos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En primer lugar, se deberá verificar todas las variables que debieron a ser respondidas por todos los casos encuestados, no estando sujetas a saltos ni filtros de ningún tipo. Como se trata de preguntas “obligatorias”, por las que todos debieron haber pasado, querremos chequear que efectivamente haya sido así. Para eso, verificaremos que no hayan valores perdidas en dichas columnas.</p>
<p>Para efectos de estandarizar, se utiliza la expresión <strong>“ERRORMISSING_[variable]”</strong>.</p>
<p>Extra: creacion de un Id , puesto que esta BBDD no lo poseía.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="malla-de-validación.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creacion de Id</span></span>
<span id="cb135-2"><a href="malla-de-validación.html#cb135-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb135-3"><a href="malla-de-validación.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Id =</span> <span class="fu">paste0</span>(id_vivienda, id_hogar, n_linea_h, id_persona, n_linea_p))</span></code></pre></div>
<div id="a-selección-de-id-y-variables-de-interés" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> a) selección de Id y variables de interés<a href="malla-de-validación.html#a-selección-de-id-y-variables-de-interés" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para este paso solo debemos cambiar la BBDD y la selección de variables obligatorias para cada caso. Además del identificador de la persona o el folio de la encuesta, el cual siempre debe seleccionarse primero, antes de las variables.</p>
<p>Es decir, se debe utilizar de la siguiente manera:</p>
<p>data_perdidos &lt;- select(BBDD,
c(Id, varX:varY))</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="malla-de-validación.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccion de variables de interes</span></span>
<span id="cb136-2"><a href="malla-de-validación.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Para este paso debemos asegurarnos que la variable Id quede al inicio de la seleccion</span></span>
<span id="cb136-3"><a href="malla-de-validación.html#cb136-3" aria-hidden="true" tabindex="-1"></a>data_perdidos <span class="ot">&lt;-</span> <span class="fu">select</span>(df,     <span class="co">#BBDD</span></span>
<span id="cb136-4"><a href="malla-de-validación.html#cb136-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">c</span>(Id, <span class="dv">98</span><span class="sc">:</span><span class="dv">101</span>)) <span class="co"># Id, variables.</span></span></code></pre></div>
</div>
<div id="b-casos-perdidos-por-fila-y-columnas" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> b) casos perdidos por fila y columnas<a href="malla-de-validación.html#b-casos-perdidos-por-fila-y-columnas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El siguiente loop nos entrega de manera automática dos objetos:</p>
<ol style="list-style-type: decimal">
<li><p><code>data_perdidos</code> = en él obtendremos un reporte que nos indicará las variables y el número de Id de la persona encuestada. De esta manera podremos identificar aquellos casos específicos donde se halle un caso perdido.</p></li>
<li><p><code>reporte_errormissing</code> = este objeto nos mostrará un conteo de errores totales por variable</p></li>
</ol>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="malla-de-validación.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Debemos asegurarnos que el loop comience con la columna 2, debido a que la 1 es el Id: i in 2:ncol.</span></span>
<span id="cb137-2"><a href="malla-de-validación.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Este loop se encuentra estandarizado. Si seguimos el paso anterior, no deberíamos tener</span></span>
<span id="cb137-3"><a href="malla-de-validación.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co"># problemas con copiar y pegar el código.</span></span>
<span id="cb137-4"><a href="malla-de-validación.html#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="malla-de-validación.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># OJO: en caso de cambiar el nombre de &quot;data_perdidos&quot; en el paso anterior,</span></span>
<span id="cb137-6"><a href="malla-de-validación.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co">#      debemos asegurarnos de actualizar el loop sobrescribiendo con ese nuevo</span></span>
<span id="cb137-7"><a href="malla-de-validación.html#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="co">#      nombre. Por ello, es mejor mantener el nombre original.</span></span>
<span id="cb137-8"><a href="malla-de-validación.html#cb137-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-9"><a href="malla-de-validación.html#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(data_perdidos)) {</span>
<span id="cb137-10"><a href="malla-de-validación.html#cb137-10" aria-hidden="true" tabindex="-1"></a>  data_perdidos[,i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(data_perdidos[i]), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb137-11"><a href="malla-de-validación.html#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(data_perdidos)[i]<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&quot;ERRORMISSING&quot;</span>, <span class="fu">names</span>(data_perdidos)[i], <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb137-12"><a href="malla-de-validación.html#cb137-12" aria-hidden="true" tabindex="-1"></a>  rep <span class="ot">&lt;-</span> data_perdidos <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;ERROR&quot;</span>))</span>
<span id="cb137-13"><a href="malla-de-validación.html#cb137-13" aria-hidden="true" tabindex="-1"></a>  reporte_errormissing <span class="ot">&lt;-</span>  <span class="fu">tibble</span>(<span class="at">variable =</span> rep <span class="sc">%&gt;%</span> colnames)</span>
<span id="cb137-14"><a href="malla-de-validación.html#cb137-14" aria-hidden="true" tabindex="-1"></a>  reporte_errormissing <span class="ot">&lt;-</span>  reporte_errormissing <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">errores =</span> rep <span class="sc">%&gt;%</span> <span class="fu">colSums</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb137-15"><a href="malla-de-validación.html#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="co">#quitar el comentario siguiente si queremos que el reporte no muestre las variables con errores=0  </span></span>
<span id="cb137-16"><a href="malla-de-validación.html#cb137-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#reporte_errormissing &lt;- reporte_errormissing[reporte_errormissing$errores &gt; 0,]  </span></span>
<span id="cb137-17"><a href="malla-de-validación.html#cb137-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(rep)</span>
<span id="cb137-18"><a href="malla-de-validación.html#cb137-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="malla-de-validación.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Opcional 1 </span><span class="al">###</span></span>
<span id="cb138-2"><a href="malla-de-validación.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Si lo necesitamos, también podemos integrar los valores perdidos a la bbdd original</span></span>
<span id="cb138-3"><a href="malla-de-validación.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Para realizar este paso es importante contar con un Id, o alguna otra </span></span>
<span id="cb138-4"><a href="malla-de-validación.html#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co"># variable en común entre los dos conjuntos de datos</span></span>
<span id="cb138-5"><a href="malla-de-validación.html#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="malla-de-validación.html#cb138-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">full_join</span>(df, data_perdidos, <span class="at">by =</span> <span class="st">&quot;Id&quot;</span>)</span>
<span id="cb138-7"><a href="malla-de-validación.html#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="malla-de-validación.html#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="malla-de-validación.html#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="do">### Opcional 2 </span><span class="al">###</span></span>
<span id="cb138-10"><a href="malla-de-validación.html#cb138-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Si nos cuesta comprender los errores mediante la codificación 0 y 1, tenemos la opción</span></span>
<span id="cb138-11"><a href="malla-de-validación.html#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co"># de recodificar estos parámetros a otros más intuitivos</span></span>
<span id="cb138-12"><a href="malla-de-validación.html#cb138-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-13"><a href="malla-de-validación.html#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="co"># data_perdidos&lt;-data_perdidos %&gt;% </span></span>
<span id="cb138-14"><a href="malla-de-validación.html#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate_at(c(2:ncol(data_perdidos)), recode, &#39;1&#39;=&#39;NA&#39;, &#39;0&#39;=&#39;Con Dato&#39;)</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="errores-de-programación" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Errores de programación<a href="malla-de-validación.html#errores-de-programación" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Por otra parte, nos interesará constatar que los saltos o filtros que contempla el cuestionario se encuentren bien aplicados, de manera que todos los encuestados hayan pasado por la secuencia lógica de preguntas que les correspondía.</p>
<p>A modo de ejemplo, en el cuestionario ENUT, quienes respondieron que en sus hogares sí trabajó personal de servicio doméstico durante la semana anterior a aquella en la que fue aplicada la encuestada, debieron responder posteriormente la pregunta respecto a cuántas personas prestaron esos servicios en dicha vivienda.</p>
<p>En este caso, vamos a denominarlos “ERRORPRO_[n° consecutivo del error]”.</p>
<p>Por tanto, vamos a programar dos errores:</p>
<ol style="list-style-type: decimal">
<li><p><code>ERRORPROG_1</code> = Si responde que la semana pasada SÍ trabajó personal servicio doméstico y luego no responde cuántas personas prestaron esos servicios; y al revés,</p></li>
<li><p><code>ERRORPROG_2</code> = Si responde que la semana pasada NO trabajó personal servicio doméstico y luego responde cuántas personas trabajaron</p></li>
</ol>
<p>Lo anterior expresado de manera gráfica sería algo así:</p>
<p>Pregunta filtro —&gt; 1. Sí trabajó personal servicio doméstico; 2. No trabajó personal servicio doméstico.
Pregunta llegada –&gt; N° de personas que trabajaron</p>
<table>
<thead>
<tr class="header">
<th align="center">P. Filtro</th>
<th align="center">P. Llegada</th>
<th align="center">Tipo de error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1 (responde que sí)</td>
<td align="center">3 (debe responder y lo hace)</td>
<td align="center">Filtro correcto</td>
</tr>
<tr class="even">
<td align="center">1 (responde que sí)</td>
<td align="center">NA (debe responder y no lo hace)</td>
<td align="center">Error prog 1</td>
</tr>
<tr class="odd">
<td align="center">2 (responde que no)</td>
<td align="center">4 (no debe responder y lo hace)</td>
<td align="center">Error prog 2</td>
</tr>
<tr class="even">
<td align="center">NA (no responde)</td>
<td align="center">2 (no debe responder y lo hace)</td>
<td align="center">Error prog 2</td>
</tr>
<tr class="odd">
<td align="center">NA (no responde)</td>
<td align="center">NA (no debe responder y no lo hace)</td>
<td align="center">No aplica criterio</td>
</tr>
</tbody>
</table>
<p>En esta ocasión, se utilizará la base de datos alterada (con errores)</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="malla-de-validación.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar bbdd</span></span>
<span id="cb139-2"><a href="malla-de-validación.html#cb139-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;BBDD/BASE_USUARIO_alterada.sav&quot;</span>)</span>
<span id="cb139-3"><a href="malla-de-validación.html#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="malla-de-validación.html#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crear id (el mismo que el caso anterior)</span></span>
<span id="cb139-5"><a href="malla-de-validación.html#cb139-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb139-6"><a href="malla-de-validación.html#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Id =</span> <span class="fu">paste0</span>(id_vivienda, id_hogar, n_linea_h, id_persona, n_linea_p))</span></code></pre></div>
<div id="a-creación-de-excel-y-criterios-de-salto" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> a) creación de excel y criterios de salto<a href="malla-de-validación.html#a-creación-de-excel-y-criterios-de-salto" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para lograr automatizar el proceso, es necesario generar un excel con las siguientes características</p>
<center>
<img src="Imagenes/Excel_errorprog.jpg" />
</center>
<p>Donde:</p>
<ul>
<li><p><code>Salida</code>: variable de filtro. Si tenemos una pregunta filtro que guía a otras múltiples preguntas, debemos repetir la variable filtro las veces necesarias, tal como se muestra en el ejemplo.</p></li>
<li><p><code>Llegada</code>: preguntas que debería contestar si se aplica el filtro.</p></li>
<li><p><code>Criterio</code>: valor que debe seleccionar la persona para que se haga efectivo el filtro.
Este criterio puede establecerse por valores enteros o rangos:</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">Criterio</th>
<th align="center">Secuencia</th>
<th align="center">Rangos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Si responde 1, 2 o 3 debe responder las preguntas de llegada</td>
<td align="center">1,2,3</td>
<td align="center">1:3</td>
</tr>
<tr class="even">
<td align="left">Si responde 1 o 3 debe respondes las preguntas de llegada</td>
<td align="center">1,3</td>
<td align="center">No aplica</td>
</tr>
</tbody>
</table>
<p>En este sentido, el ejemplo se leería de la siguiente manera: si la persona responde “sí” en la pregunta f11_1_1, debe responder también la pregunta f12_1_1. A su vez, si responde “sí” en la pregunta f11_1_1, también debería resonder la pregunta f13_1_2</p>
<p><strong>¡IMPORTANTE: ES NECESARIO QUE LAS COLUMNAS DEL EXCEL SE ENCUENTREN EN FORMATO TEXTO!</strong></p>
</div>
<div id="b-aplicación-del-loop" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> b) aplicación del loop<a href="malla-de-validación.html#b-aplicación-del-loop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El loop que viene a continuación se encuentra automatizado. Si se han seguido correctamente los pasos anteriores y el excel se encuentra correctamente construido no deberían haber problemas en su ejecución.</p>
<p>En este sentido, lo primero que debemos hacer es cargar nuestro excel con las preguntas listas.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="malla-de-validación.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb140-2"><a href="malla-de-validación.html#cb140-2" aria-hidden="true" tabindex="-1"></a>varsprog <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;BBDD/ERRORPROG_EJ.xlsx&quot;</span>)</span></code></pre></div>
<p>Luego, crearemos vectores específicos con los elementos provenientes de nuestro excel.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="malla-de-validación.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vectores de variables y criterios ---------------------------------------</span></span>
<span id="cb141-2"><a href="malla-de-validación.html#cb141-2" aria-hidden="true" tabindex="-1"></a>salida<span class="ot">&lt;-</span><span class="fu">c</span>(varsprog<span class="sc">$</span>Salida)</span>
<span id="cb141-3"><a href="malla-de-validación.html#cb141-3" aria-hidden="true" tabindex="-1"></a>llegada<span class="ot">&lt;-</span><span class="fu">c</span>(varsprog<span class="sc">$</span>Llegada)</span>
<span id="cb141-4"><a href="malla-de-validación.html#cb141-4" aria-hidden="true" tabindex="-1"></a>criterio.salto<span class="ot">&lt;-</span><span class="fu">c</span>(varsprog<span class="sc">$</span>Criterio)</span>
<span id="cb141-5"><a href="malla-de-validación.html#cb141-5" aria-hidden="true" tabindex="-1"></a>criterio.salto<span class="ot">&lt;-</span> <span class="fu">str_replace</span>(criterio.salto, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>El siguiente paso es generar un nuevo objeto donde se almacenen los resultados del loop y que contenga el Id del encuestado, para poder así identificar el caso a caso.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="malla-de-validación.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># la seleccion del Id puede cambiar segun BBDD. En este ejemplo el id se</span></span>
<span id="cb142-2"><a href="malla-de-validación.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co"># llamada &quot;Id&quot;.</span></span>
<span id="cb142-3"><a href="malla-de-validación.html#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="malla-de-validación.html#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="do">### OJO: si cambian el nombre de &quot;erroresprog&quot; deberán cambiarlo también dentro del loop </span><span class="al">###</span></span>
<span id="cb142-5"><a href="malla-de-validación.html#cb142-5" aria-hidden="true" tabindex="-1"></a>erroresprog<span class="ot">&lt;-</span><span class="fu">data.frame</span>(df<span class="sc">$</span>Id)</span></code></pre></div>
<p>Finalmente, ejecutamos el loop:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="malla-de-validación.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos una funcion que servira para traducir en una secuencia de numeros imputs</span></span>
<span id="cb143-2"><a href="malla-de-validación.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># como &quot;1 3&quot; o &quot;9&quot;. Para ambos casos devolver?a &quot;1 2 3&quot;  y &quot;9&quot; respectivamente</span></span>
<span id="cb143-3"><a href="malla-de-validación.html#cb143-3" aria-hidden="true" tabindex="-1"></a>secuencia<span class="ot">&lt;-</span><span class="cf">function</span>(objeto){</span>
<span id="cb143-4"><a href="malla-de-validación.html#cb143-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(objeto)</span>
<span id="cb143-5"><a href="malla-de-validación.html#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq</span>(objeto[[<span class="dv">1</span>]],objeto[[n]])</span>
<span id="cb143-6"><a href="malla-de-validación.html#cb143-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-7"><a href="malla-de-validación.html#cb143-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-8"><a href="malla-de-validación.html#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="malla-de-validación.html#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="co"># LOOP</span></span>
<span id="cb143-10"><a href="malla-de-validación.html#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(salida)){</span>
<span id="cb143-11"><a href="malla-de-validación.html#cb143-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-12"><a href="malla-de-validación.html#cb143-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1ra parte, traducir en un rango de numeros imputs de caracteres como por ejemplo</span></span>
<span id="cb143-13"><a href="malla-de-validación.html#cb143-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &quot;2,5&quot; en los numeros &quot;2 5&quot;. imputs como &quot;1:3&quot;, en rangos &quot;1 2 3&quot;. Y unidades</span></span>
<span id="cb143-14"><a href="malla-de-validación.html#cb143-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># como &quot;4&quot;, en el numero al que corresponden </span></span>
<span id="cb143-15"><a href="malla-de-validación.html#cb143-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-16"><a href="malla-de-validación.html#cb143-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span> ((<span class="fu">str_detect</span>(criterio.salto[i],<span class="st">&quot;,&quot;</span>)), </span>
<span id="cb143-17"><a href="malla-de-validación.html#cb143-17" aria-hidden="true" tabindex="-1"></a>          rango<span class="ot">&lt;-</span> criterio.salto[i] <span class="sc">%&gt;%</span> <span class="fu">str_split</span>(<span class="st">&quot;,&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-18"><a href="malla-de-validación.html#cb143-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb143-19"><a href="malla-de-validación.html#cb143-19" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb143-20"><a href="malla-de-validación.html#cb143-20" aria-hidden="true" tabindex="-1"></a>          rango<span class="ot">&lt;-</span>criterio.salto[i] <span class="sc">%&gt;%</span> <span class="fu">str_split</span>(<span class="st">&quot;:&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb143-21"><a href="malla-de-validación.html#cb143-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span> secuencia</span>
<span id="cb143-22"><a href="malla-de-validación.html#cb143-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb143-23"><a href="malla-de-validación.html#cb143-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-24"><a href="malla-de-validación.html#cb143-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identifica la posicion en el data frame, de la variable/columna de salto</span></span>
<span id="cb143-25"><a href="malla-de-validación.html#cb143-25" aria-hidden="true" tabindex="-1"></a>  coordenada1<span class="ot">&lt;-</span><span class="fu">grep</span>(<span class="fu">paste</span>(<span class="st">&quot;^&quot;</span>,salida[i],<span class="st">&quot;$&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="fu">names</span>(df))</span>
<span id="cb143-26"><a href="malla-de-validación.html#cb143-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identifica la posicion en el data frame, de la variable/columna de llegada</span></span>
<span id="cb143-27"><a href="malla-de-validación.html#cb143-27" aria-hidden="true" tabindex="-1"></a>  coordenada2<span class="ot">&lt;-</span><span class="fu">grep</span>(<span class="fu">paste</span>(<span class="st">&quot;^&quot;</span>,llegada[i],<span class="st">&quot;$&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="fu">names</span>(df))</span>
<span id="cb143-28"><a href="malla-de-validación.html#cb143-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-29"><a href="malla-de-validación.html#cb143-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Chequea si la variable de salto tiene obervaciones que cumplen la condicion </span></span>
<span id="cb143-30"><a href="malla-de-validación.html#cb143-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># de salto</span></span>
<span id="cb143-31"><a href="malla-de-validación.html#cb143-31" aria-hidden="true" tabindex="-1"></a>  s.check<span class="ot">&lt;-</span>((<span class="fu">as.integer</span>(<span class="fu">unlist</span>(df[,coordenada1]))) <span class="sc">%in%</span> rango)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb143-32"><a href="malla-de-validación.html#cb143-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-33"><a href="malla-de-validación.html#cb143-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Chequea si la variable de llegada tiene obervaciones</span></span>
<span id="cb143-34"><a href="malla-de-validación.html#cb143-34" aria-hidden="true" tabindex="-1"></a>  ll.check<span class="ot">&lt;-</span>(<span class="sc">!</span><span class="fu">is.na</span>(df)[,coordenada2])<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb143-35"><a href="malla-de-validación.html#cb143-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-36"><a href="malla-de-validación.html#cb143-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se pegan los resultados anteriores, que son agregados al otro data frame</span></span>
<span id="cb143-37"><a href="malla-de-validación.html#cb143-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creado previamente, donde se registraron los resultados para cada individuo</span></span>
<span id="cb143-38"><a href="malla-de-validación.html#cb143-38" aria-hidden="true" tabindex="-1"></a>  revision<span class="ot">&lt;-</span><span class="fu">paste0</span>(s.check,ll.check)</span>
<span id="cb143-39"><a href="malla-de-validación.html#cb143-39" aria-hidden="true" tabindex="-1"></a>  erroresprog<span class="ot">&lt;-</span><span class="fu">cbind</span>(revision,erroresprog)</span>
<span id="cb143-40"><a href="malla-de-validación.html#cb143-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(coordenada1, coordenada2, ll.check, s.check, rango, i, revision)</span>
<span id="cb143-41"><a href="malla-de-validación.html#cb143-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-42"><a href="malla-de-validación.html#cb143-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-43"><a href="malla-de-validación.html#cb143-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos un vector vacio para almacenar los nombres de las variables</span></span>
<span id="cb143-44"><a href="malla-de-validación.html#cb143-44" aria-hidden="true" tabindex="-1"></a>nombres.u<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb143-45"><a href="malla-de-validación.html#cb143-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-46"><a href="malla-de-validación.html#cb143-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Ingresamos los nombres de las columnas del data frame de revision, pegando los</span></span>
<span id="cb143-47"><a href="malla-de-validación.html#cb143-47" aria-hidden="true" tabindex="-1"></a><span class="co"># nombres de las variables y salto llegada que correspondan, mas el criterio de salto </span></span>
<span id="cb143-48"><a href="malla-de-validación.html#cb143-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(llegada)){</span>
<span id="cb143-49"><a href="malla-de-validación.html#cb143-49" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">paste0</span>(salida[i],<span class="st">&quot;-&quot;</span>,llegada[i], <span class="st">&quot; (&quot;</span>,criterio.salto[i],<span class="st">&quot;)&quot;</span>)</span>
<span id="cb143-50"><a href="malla-de-validación.html#cb143-50" aria-hidden="true" tabindex="-1"></a>  nombres.u<span class="ot">&lt;-</span><span class="fu">append</span>(nombres.u,x1)</span>
<span id="cb143-51"><a href="malla-de-validación.html#cb143-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-52"><a href="malla-de-validación.html#cb143-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(salida, llegada, criterio.salto, i, x1)</span>
<span id="cb143-53"><a href="malla-de-validación.html#cb143-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-54"><a href="malla-de-validación.html#cb143-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar base de datos de revision y añadir etiquetas</span></span>
<span id="cb143-55"><a href="malla-de-validación.html#cb143-55" aria-hidden="true" tabindex="-1"></a>erroresprog <span class="ot">&lt;-</span> <span class="fu">rev</span>(erroresprog)</span>
<span id="cb143-56"><a href="malla-de-validación.html#cb143-56" aria-hidden="true" tabindex="-1"></a>etiquetas <span class="ot">&lt;-</span> <span class="fu">append</span>(<span class="st">&quot;id&quot;</span>, nombres.u)</span>
<span id="cb143-57"><a href="malla-de-validación.html#cb143-57" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(erroresprog)<span class="ot">&lt;-</span>etiquetas</span>
<span id="cb143-58"><a href="malla-de-validación.html#cb143-58" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(etiquetas, nombres.u, secuencia)</span>
<span id="cb143-59"><a href="malla-de-validación.html#cb143-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-60"><a href="malla-de-validación.html#cb143-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificar la nomenclatura de error para una mejor comprension</span></span>
<span id="cb143-61"><a href="malla-de-validación.html#cb143-61" aria-hidden="true" tabindex="-1"></a>erroresprog<span class="ot">&lt;-</span>erroresprog <span class="sc">%&gt;%</span></span>
<span id="cb143-62"><a href="malla-de-validación.html#cb143-62" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(erroresprog)), </span>
<span id="cb143-63"><a href="malla-de-validación.html#cb143-63" aria-hidden="true" tabindex="-1"></a>                   dplyr<span class="sc">::</span>recode,</span>
<span id="cb143-64"><a href="malla-de-validación.html#cb143-64" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;11&#39;</span><span class="ot">=</span><span class="st">&#39;FILTRO_CORRECTO&#39;</span>,</span>
<span id="cb143-65"><a href="malla-de-validación.html#cb143-65" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;10&#39;</span><span class="ot">=</span><span class="st">&#39;ERRORPROG_1&#39;</span>,</span>
<span id="cb143-66"><a href="malla-de-validación.html#cb143-66" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;01&#39;</span><span class="ot">=</span><span class="st">&#39;ERRORPROG_2&#39;</span>,</span>
<span id="cb143-67"><a href="malla-de-validación.html#cb143-67" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;00&#39;</span><span class="ot">=</span><span class="st">&#39;NO APLICA&#39;</span>)</span></code></pre></div>
<p>Una vez tengamos los resultados del loop insertos en nuestro objeto <code>erroresprog</code>, podemos generar tablas de frecuecia que nos indiquen la cantidad de errores en las variables.</p>
<p>Para ello utilizaremos la librería <code>sjmisc</code> y su función <code>frq</code>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="malla-de-validación.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb144-2"><a href="malla-de-validación.html#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="malla-de-validación.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Para generar reportes solo pedimos de la frecuencia de las variables de interes</span></span>
<span id="cb144-4"><a href="malla-de-validación.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># frq(errorprog$variable_x)</span></span>
<span id="cb144-5"><a href="malla-de-validación.html#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">frq</span>(erroresprog<span class="sc">$</span><span class="st">`</span><span class="at">f11_1_1-f12_1_1 (1)</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## 
## x &lt;character&gt;
## # total N=34575  valid N=34575  mean=3.97  sd=0.17
## 
## Value           |     N | Raw % | Valid % | Cum. %
## --------------------------------------------------
## ERRORPROG_1     |     8 |  0.02 |    0.02 |   0.02
## ERRORPROG_2     |    11 |  0.03 |    0.03 |   0.05
## FILTRO_CORRECTO |   882 |  2.55 |    2.55 |   2.61
## NO APLICA       | 33674 | 97.39 |   97.39 | 100.00
## &lt;NA&gt;            |     0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
<p><strong>Como vemos, tenemos 8 casos de Errorporg_1 y 11 con Errorprog_2 (aquellos que fueron alterados de forma manual en la BBDD para efectos del ejemplo).</strong></p>
<hr />
</div>
</div>
<div id="errores-de-consistencia" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Errores de consistencia<a href="malla-de-validación.html#errores-de-consistencia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finalmente, verificaremos que no existan inconsistencias lógicas en las respuestas de los encuestados (por ejemplo: tener 21 años o menos y afirmar tener nivel educacional de magister o doctarado completo) o la existencia de valores fuera de rango en variables númericas (por ejemplo, variable de edad con casos menores de 18, si es que solo debían responderla mayores de edad).</p>
<p>En este caso, vamos a denominarlos “ERRORCON_[n° consecutivo del error]”.</p>
<p>A modo de ejemplo, primero programaremos un caso de respuestas inconsistentes. En este caso, se verificará que no haya casos su edad (c14_1_1) no sea consistente con su nivel educacional (d12_1_1). Para ello, se utilizará la BBDD alterada con errores.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="malla-de-validación.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar bbdd</span></span>
<span id="cb146-2"><a href="malla-de-validación.html#cb146-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;BBDD/BASE_USUARIO_alterada.sav&quot;</span>)</span>
<span id="cb146-3"><a href="malla-de-validación.html#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="malla-de-validación.html#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crear id (el mismo que el caso anterior)</span></span>
<span id="cb146-5"><a href="malla-de-validación.html#cb146-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb146-6"><a href="malla-de-validación.html#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Id =</span> <span class="fu">paste0</span>(id_vivienda, id_hogar, n_linea_h, id_persona, n_linea_p))</span></code></pre></div>
<p>Como se observa en la tabla de salida, tenemos 6 errores con casos cuya edad es inferior a los 20 años, pero declaran poseer estudios de magíster o doctorado.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="malla-de-validación.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="do">##ERRORCON_1: Responde que tiene estudios de magister o doctorado y edad inferior a 21 años</span></span>
<span id="cb147-2"><a href="malla-de-validación.html#cb147-2" aria-hidden="true" tabindex="-1"></a>data_errorcon   <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ERRORCON_1 =</span> <span class="fu">case_when</span>(c14_1_1 <span class="sc">&lt;=</span> <span class="dv">21</span> <span class="sc">&amp;</span> (d12_1_1 <span class="sc">==</span> <span class="dv">14</span> <span class="sc">|</span> d12_1_1 <span class="sc">==</span> <span class="dv">15</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>))</span>
<span id="cb147-3"><a href="malla-de-validación.html#cb147-3" aria-hidden="true" tabindex="-1"></a>data_errorcon_ce_1 <span class="ot">&lt;-</span> data_errorcon <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ERRORCON_1 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb147-4"><a href="malla-de-validación.html#cb147-4" aria-hidden="true" tabindex="-1"></a>data_errorcon_ce_1 <span class="ot">&lt;-</span> data_errorcon_ce_1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Id,ERRORCON_1,c14_1_1,d12_1_1)</span>
<span id="cb147-5"><a href="malla-de-validación.html#cb147-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data_errorcon_ce_1, <span class="at">caption =</span> <span class="st">&quot;Tabla: Identificación de observaciones con ERRORCON_1&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-157">Table 5.1: </span>Tabla: Identificación de observaciones con ERRORCON_1</caption>
<thead>
<tr class="header">
<th align="left">Id</th>
<th align="right">ERRORCON_1</th>
<th align="right">c14_1_1</th>
<th align="right">d12_1_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">331104</td>
<td align="right">1</td>
<td align="right">17</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">551173</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">20211763</td>
<td align="right">1</td>
<td align="right">17</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="left">21221813</td>
<td align="right">1</td>
<td align="right">19</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">293011023</td>
<td align="right">1</td>
<td align="right">18</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="left">434411513</td>
<td align="right">1</td>
<td align="right">16</td>
<td align="right">15</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="errores-de-rango" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Errores de rango<a href="malla-de-validación.html#errores-de-rango" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para el caso de los errores de rango, se hará uso de un loop para delimitar el límite inferior y superior en el que se espera que se encuentren los valores, generando un error cuando el valor observado se encuentra fuera de ese rango. En este caso, se utilizará la BBDD corregida, estableciendo un rango de edad que se mueve entre 0 y 99 años.</p>
<div id="a-creación-de-excel-y-criterios-de-rango" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> a) creación de excel y criterios de rango<a href="malla-de-validación.html#a-creación-de-excel-y-criterios-de-rango" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para lograr automatizar el proceso, es necesario generar un excel con las siguientes características</p>
<center>
<img src="Imagenes/Excel_errorrango.jpg" />
</center>
<p>Donde:</p>
<ul>
<li><p><code>Variable</code>: son todas aquellas variables que queremos identificar el correcto rango.</p></li>
<li><p><code>Criterio</code>: rango que deben contener las respuestas</p></li>
</ul>
</div>
<div id="b-aplicación-del-loop-1" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> b) aplicación del loop<a href="malla-de-validación.html#b-aplicación-del-loop-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El loop que viene a continuación se encuentra automatizado. Si se han seguido correctamente los pasos anteriores y el excel se encuentra correctamente construido no deberían haber problemas en su ejecución.</p>
<p>En este sentido, lo primero que debemos hacer es cargar nuestro excel con las preguntas listas.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="malla-de-validación.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb148-2"><a href="malla-de-validación.html#cb148-2" aria-hidden="true" tabindex="-1"></a>varsrango <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;BBDD/ERRORCON2_EJ.xlsx&quot;</span>)</span></code></pre></div>
<p>Luego, crearemos vectores específicos con los elementos provenientes de nuestro excel.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="malla-de-validación.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vectores de variables y criterios ---------------------------------------</span></span>
<span id="cb149-2"><a href="malla-de-validación.html#cb149-2" aria-hidden="true" tabindex="-1"></a>var<span class="ot">&lt;-</span><span class="fu">c</span>(varsrango<span class="sc">$</span>Variable)</span>
<span id="cb149-3"><a href="malla-de-validación.html#cb149-3" aria-hidden="true" tabindex="-1"></a>criterio.rango<span class="ot">&lt;-</span><span class="fu">c</span>(varsrango<span class="sc">$</span>Criterio)</span>
<span id="cb149-4"><a href="malla-de-validación.html#cb149-4" aria-hidden="true" tabindex="-1"></a>criterio.rango<span class="ot">&lt;-</span> <span class="fu">str_replace</span>(criterio.rango, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>El siguiente paso es generar un nuevo objeto donde se almacenen los resultados del loop y que contenga el Id del encuestado, para poder así identificar el caso a caso.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="malla-de-validación.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># la seleccion del Id puede cambiar segun BBDD. En este ejemplo el id se</span></span>
<span id="cb150-2"><a href="malla-de-validación.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># llamada &quot;Id&quot;.</span></span>
<span id="cb150-3"><a href="malla-de-validación.html#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="malla-de-validación.html#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="do">### OJO: si cambian el nombre de &quot;erroresprog&quot; deberán cambiarlo también dentro del loop </span><span class="al">###</span></span>
<span id="cb150-5"><a href="malla-de-validación.html#cb150-5" aria-hidden="true" tabindex="-1"></a>erroresrango <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(Id)</span></code></pre></div>
<p>Finalmente, ejecutamos el loop:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="malla-de-validación.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LOOP --------------------------------------------------------------------</span></span>
<span id="cb151-2"><a href="malla-de-validación.html#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="malla-de-validación.html#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos una funcion que servira para traducir en una secuencia de numeros imputs</span></span>
<span id="cb151-4"><a href="malla-de-validación.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co"># como &quot;1 3&quot; o &quot;9&quot;. Para ambos casos devolver?a &quot;1 2 3&quot;  y &quot;9&quot; respectivamente</span></span>
<span id="cb151-5"><a href="malla-de-validación.html#cb151-5" aria-hidden="true" tabindex="-1"></a>secuencia<span class="ot">&lt;-</span><span class="cf">function</span>(objeto){</span>
<span id="cb151-6"><a href="malla-de-validación.html#cb151-6" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(objeto)</span>
<span id="cb151-7"><a href="malla-de-validación.html#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq</span>(objeto[[<span class="dv">1</span>]],objeto[[n]])</span>
<span id="cb151-8"><a href="malla-de-validación.html#cb151-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-9"><a href="malla-de-validación.html#cb151-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-10"><a href="malla-de-validación.html#cb151-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-11"><a href="malla-de-validación.html#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb151-12"><a href="malla-de-validación.html#cb151-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var)){</span>
<span id="cb151-13"><a href="malla-de-validación.html#cb151-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span> ((<span class="fu">str_detect</span>(criterio.rango[i],<span class="st">&quot;,&quot;</span>)),</span>
<span id="cb151-14"><a href="malla-de-validación.html#cb151-14" aria-hidden="true" tabindex="-1"></a>          rango<span class="ot">&lt;-</span> criterio.rango[i] <span class="sc">%&gt;%</span> <span class="fu">str_split</span>(<span class="st">&quot;,&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb151-15"><a href="malla-de-validación.html#cb151-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb151-16"><a href="malla-de-validación.html#cb151-16" aria-hidden="true" tabindex="-1"></a>          rango<span class="ot">&lt;-</span>criterio.rango[i] <span class="sc">%&gt;%</span> <span class="fu">str_split</span>(<span class="st">&quot;:&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb151-17"><a href="malla-de-validación.html#cb151-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span> secuencia</span>
<span id="cb151-18"><a href="malla-de-validación.html#cb151-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb151-19"><a href="malla-de-validación.html#cb151-19" aria-hidden="true" tabindex="-1"></a>  coordenada1<span class="ot">&lt;-</span><span class="fu">grep</span>(<span class="fu">paste</span>(<span class="st">&quot;^&quot;</span>,var[i],<span class="st">&quot;$&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="fu">names</span>(df))</span>
<span id="cb151-20"><a href="malla-de-validación.html#cb151-20" aria-hidden="true" tabindex="-1"></a>  variable1<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">unlist</span>(df[,coordenada1]))</span>
<span id="cb151-21"><a href="malla-de-validación.html#cb151-21" aria-hidden="true" tabindex="-1"></a>  na.check<span class="ot">&lt;-</span>(<span class="fu">is.na</span>(variable1))<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb151-22"><a href="malla-de-validación.html#cb151-22" aria-hidden="true" tabindex="-1"></a>  rango.check<span class="ot">&lt;-</span>(variable1 <span class="sc">%in%</span>  rango)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb151-23"><a href="malla-de-validación.html#cb151-23" aria-hidden="true" tabindex="-1"></a>  revision<span class="ot">&lt;-</span><span class="fu">paste0</span>(na.check,rango.check)</span>
<span id="cb151-24"><a href="malla-de-validación.html#cb151-24" aria-hidden="true" tabindex="-1"></a>  erroresrango<span class="ot">&lt;-</span><span class="fu">cbind</span>(revision,erroresrango)</span>
<span id="cb151-25"><a href="malla-de-validación.html#cb151-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(coordenada1, i, na.check, rango.check, rango, variable1, revision)</span>
<span id="cb151-26"><a href="malla-de-validación.html#cb151-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-27"><a href="malla-de-validación.html#cb151-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-28"><a href="malla-de-validación.html#cb151-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos un vector vacio para almacenar los nombres de las variables</span></span>
<span id="cb151-29"><a href="malla-de-validación.html#cb151-29" aria-hidden="true" tabindex="-1"></a>nombres.u<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb151-30"><a href="malla-de-validación.html#cb151-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-31"><a href="malla-de-validación.html#cb151-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Ingresamos los nombres de las columnas del data frame de revision, pegando los</span></span>
<span id="cb151-32"><a href="malla-de-validación.html#cb151-32" aria-hidden="true" tabindex="-1"></a><span class="co"># nombres de las variables y salto llegada que correspondan, mas el criterio de salto </span></span>
<span id="cb151-33"><a href="malla-de-validación.html#cb151-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var)){</span>
<span id="cb151-34"><a href="malla-de-validación.html#cb151-34" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">paste0</span>(var[i], <span class="st">&quot; (&quot;</span>,criterio.rango[i],<span class="st">&quot;)&quot;</span>)</span>
<span id="cb151-35"><a href="malla-de-validación.html#cb151-35" aria-hidden="true" tabindex="-1"></a>  nombres.u<span class="ot">&lt;-</span><span class="fu">append</span>(nombres.u,x1)</span>
<span id="cb151-36"><a href="malla-de-validación.html#cb151-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-37"><a href="malla-de-validación.html#cb151-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-38"><a href="malla-de-validación.html#cb151-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordenar base de datos de revision y añadir etiquetas</span></span>
<span id="cb151-39"><a href="malla-de-validación.html#cb151-39" aria-hidden="true" tabindex="-1"></a>erroresrango<span class="ot">&lt;-</span><span class="fu">rev</span>(erroresrango)</span>
<span id="cb151-40"><a href="malla-de-validación.html#cb151-40" aria-hidden="true" tabindex="-1"></a>etiquetas<span class="ot">&lt;-</span>  <span class="fu">append</span>(<span class="st">&quot;id&quot;</span>, nombres.u)</span>
<span id="cb151-41"><a href="malla-de-validación.html#cb151-41" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(erroresrango)<span class="ot">&lt;-</span>etiquetas</span>
<span id="cb151-42"><a href="malla-de-validación.html#cb151-42" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(criterio.rango, etiquetas, i, nombres.u, var, x1, secuencia)</span>
<span id="cb151-43"><a href="malla-de-validación.html#cb151-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-44"><a href="malla-de-validación.html#cb151-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificacisn sugerida de las observaciones</span></span>
<span id="cb151-45"><a href="malla-de-validación.html#cb151-45" aria-hidden="true" tabindex="-1"></a>erroresrango<span class="ot">&lt;-</span>erroresrango <span class="sc">%&gt;%</span></span>
<span id="cb151-46"><a href="malla-de-validación.html#cb151-46" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(erroresrango)), dplyr<span class="sc">::</span>recode, </span>
<span id="cb151-47"><a href="malla-de-validación.html#cb151-47" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;00&#39;</span><span class="ot">=</span><span class="st">&#39;Fuera de rango&#39;</span>,</span>
<span id="cb151-48"><a href="malla-de-validación.html#cb151-48" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;01&#39;</span><span class="ot">=</span><span class="st">&#39;Rango correcto&#39;</span>, </span>
<span id="cb151-49"><a href="malla-de-validación.html#cb151-49" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&#39;10&#39;</span><span class="ot">=</span><span class="st">&#39;NA&#39;</span>)</span></code></pre></div>
<p>Una vez tengamos los resultados del loop insertos en nuestro objeto <code>erroresrango</code>, podemos generar tablas de frecuencia que nos indiquen la cantidad de errores de rango en las variables.</p>
<p>Para ello utilizaremos la librería <code>sjmisc</code> y su función <code>frq</code>.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="malla-de-validación.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb152-2"><a href="malla-de-validación.html#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="malla-de-validación.html#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Para generar reportes solo pedimos de la frecuencia de las variables de interes</span></span>
<span id="cb152-4"><a href="malla-de-validación.html#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="co"># frq(errorprog$variable_x)</span></span>
<span id="cb152-5"><a href="malla-de-validación.html#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="fu">frq</span>(erroresrango<span class="sc">$</span><span class="st">`</span><span class="at">c14_1_1 (0:99)</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## 
## x &lt;character&gt;
## # total N=34575  valid N=34575  mean=2.00  sd=0.01
## 
## Value          |     N | Raw % | Valid % | Cum. %
## -------------------------------------------------
## Fuera de rango |     1 |     0 |       0 |      0
## Rango correcto | 34574 |   100 |     100 |    100
## &lt;NA&gt;           |     0 |     0 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
<p><strong>Como vemos, solo tenemos un caso que no cumple con el rango establecido</strong></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="clasificación-por-nivel-socio-económico-metodología-aim.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="construcción-de-ponderadores-por-raking.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Jona-S99/Bookdown/edit/master/05-Malla_validacion.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Jona-S99/Bookdown/blob/master/05-Malla_validacion.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
