<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 3 Automatización de tabulaciones de variables (de frecuencia, contingencia y diferencia de medias) | Bookdown D&amp;A</title>
  <meta name="description" content=" 3 Automatización de tabulaciones de variables (de frecuencia, contingencia y diferencia de medias) | Bookdown D&amp;A" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content=" 3 Automatización de tabulaciones de variables (de frecuencia, contingencia y diferencia de medias) | Bookdown D&amp;A" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 3 Automatización de tabulaciones de variables (de frecuencia, contingencia y diferencia de medias) | Bookdown D&amp;A" />
  
  
  

<meta name="author" content="Jonatan Salazar" />


<meta name="date" content="2022-06-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="procesamiento-de-base-de-datos.html"/>
<link rel="next" href="clasificación-por-nivel-socio-económico-metodología-aim.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.21/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bookdown Datavoz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html"><i class="fa fa-check"></i><b>2</b> Procesamiento de Base de Datos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-de-utilidad-general"><i class="fa fa-check"></i><b>2.1</b> Operadores de utilidad general</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-relacionales"><i class="fa fa-check"></i><b>2.1.1</b> <strong>1. Operadores relacionales</strong></a></li>
<li class="chapter" data-level="2.1.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-aritméticos"><i class="fa fa-check"></i><b>2.1.2</b> <strong>2. Operadores aritméticos</strong></a></li>
<li class="chapter" data-level="2.1.3" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-de-asignación"><i class="fa fa-check"></i><b>2.1.3</b> <strong>3. Operadores de asignación</strong></a></li>
<li class="chapter" data-level="2.1.4" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operadores-booleanos"><i class="fa fa-check"></i><b>2.1.4</b> <strong>4. Operadores booleanos</strong></a></li>
<li class="chapter" data-level="2.1.5" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#operador-pipeline"><i class="fa fa-check"></i><b>2.1.5</b> <strong>5. Operador pipeline (%&gt;%)</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#manipulación-de-estructutura-de-bases-de-datos"><i class="fa fa-check"></i><b>2.2</b> Manipulación de estructutura de bases de datos</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tipos-de-variables"><i class="fa fa-check"></i><b>2.2.1</b> Tipos de variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#coerción-explícita"><i class="fa fa-check"></i><b>2.2.2</b> Coerción explícita</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#crear-nuevas-variables"><i class="fa fa-check"></i><b>2.3</b> Crear nuevas variables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#r-base"><i class="fa fa-check"></i><b>2.3.1</b> <strong>1. R Base</strong></a></li>
<li class="chapter" data-level="2.3.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse"><i class="fa fa-check"></i><b>2.3.2</b> <strong>2. Tidyverse</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#limpiar-y-renombrar-variables"><i class="fa fa-check"></i><b>2.4</b> Limpiar y renombrar variables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#limpiar-nombre-de-variables-librería-janitor"><i class="fa fa-check"></i><b>2.4.1</b> <strong>1. Limpiar nombre de variables, librería “janitor”</strong></a></li>
<li class="chapter" data-level="2.4.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#renombrar-variables"><i class="fa fa-check"></i><b>2.4.2</b> <strong>2. Renombrar variables</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#reordenar-variables"><i class="fa fa-check"></i><b>2.5</b> Reordenar variables</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#r-base-2"><i class="fa fa-check"></i><b>2.5.1</b> <strong>1. R base</strong></a></li>
<li class="chapter" data-level="2.5.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse-2"><i class="fa fa-check"></i><b>2.5.2</b> <strong>2. Tidyverse</strong></a></li>
<li class="chapter" data-level="2.5.3" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#función-personalizada"><i class="fa fa-check"></i><b>2.5.3</b> <strong>3. Función personalizada</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#recodificación-de-variables"><i class="fa fa-check"></i><b>2.6</b> Recodificación de variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#r-base-3"><i class="fa fa-check"></i><b>2.6.1</b> <strong>1. R base</strong></a></li>
<li class="chapter" data-level="2.6.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse-3"><i class="fa fa-check"></i><b>2.6.2</b> <strong>2. Tidyverse</strong></a></li>
<li class="chapter" data-level="2.6.3" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#car"><i class="fa fa-check"></i><b>2.6.3</b> <strong>3. Car</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#selección-de-variables"><i class="fa fa-check"></i><b>2.7</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#r-base-4"><i class="fa fa-check"></i><b>2.7.1</b> <strong>R Base</strong></a></li>
<li class="chapter" data-level="2.7.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse-4"><i class="fa fa-check"></i><b>2.7.2</b> <strong>Tidyverse</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#filtrar-casos"><i class="fa fa-check"></i><b>2.8</b> Filtrar casos</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#tidyverse-5"><i class="fa fa-check"></i><b>2.8.1</b> <strong>Tidyverse</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#bases-de-datos-long-y-wide"><i class="fa fa-check"></i><b>2.9</b> Bases de datos Long y Wide</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#de-long-a-wider"><i class="fa fa-check"></i><b>2.9.1</b> <strong>1. De long a wider</strong></a></li>
<li class="chapter" data-level="2.9.2" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#de-wider-a-long"><i class="fa fa-check"></i><b>2.9.2</b> <strong>2. De wider a long</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="procesamiento-de-base-de-datos.html"><a href="procesamiento-de-base-de-datos.html#colapsar-variables"><i class="fa fa-check"></i><b>2.10</b> Colapsar variables</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><i class="fa fa-check"></i><b>3</b> Automatización de tabulaciones de variables (de frecuencia, contingencia y diferencia de medias)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#tablas-de-frecuenciacontingencia"><i class="fa fa-check"></i><b>3.1</b> Tablas de frecuencia/contingencia</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cargar-nuestra-bbdd"><i class="fa fa-check"></i><b>3.1.1</b> <strong>1. Cargar nuestra BBDD</strong></a></li>
<li class="chapter" data-level="3.1.2" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creamos-un-banner"><i class="fa fa-check"></i><b>3.1.2</b> <strong>2. Creamos un banner</strong></a></li>
<li class="chapter" data-level="3.1.3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#una-vez-creamos-nuestro-objeto-banner-debemos-crear-una-función-capaz-de-crear-las-diferencias-proporcionales"><i class="fa fa-check"></i><b>3.1.3</b> <strong>3. Una vez creamos nuestro objeto banner, debemos crear una función capaz de crear las diferencias proporcionales</strong></a></li>
<li class="chapter" data-level="3.1.4" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creación-de-secciones-recomendado"><i class="fa fa-check"></i><b>3.1.4</b> <strong>4. Creación de secciones (Recomendado)</strong></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#tablas-de-diferencias-de-medias"><i class="fa fa-check"></i><b>3.2</b> Tablas de diferencias de medias</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creamos-un-banner-1"><i class="fa fa-check"></i><b>3.2.1</b> <strong>1. Creamos un banner</strong></a></li>
<li class="chapter" data-level="3.2.2" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creamos-una-función-que-nos-permita-calcular-las-diferencias-de-medias"><i class="fa fa-check"></i><b>3.2.2</b> <strong>2. Creamos una función que nos permita calcular las diferencias de medias</strong></a></li>
<li class="chapter" data-level="3.2.3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creación-de-secciones-recomendado-1"><i class="fa fa-check"></i><b>3.2.3</b> <strong>3. Creación de secciones (Recomendado)</strong></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#exportar-tablas-a-excel"><i class="fa fa-check"></i><b>3.3</b> Exportar tablas a excel</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#independientes-porcentajes"><i class="fa fa-check"></i><b>3.3.1</b> 1. Independientes: porcentajes</a></li>
<li class="chapter" data-level="3.3.2" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#independientes-diferencia-de-medias"><i class="fa fa-check"></i><b>3.3.2</b> 2. Independientes: diferencia de medias</a></li>
<li class="chapter" data-level="3.3.3" data-path="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#en-conjunto-porcentaje-y-dif-de-medias-en-un-solo-archivo"><i class="fa fa-check"></i><b>3.3.3</b> 3. En conjunto: porcentaje y dif de medias en un solo archivo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html"><i class="fa fa-check"></i><b>4</b> Clasificación por nivel socio-económico (Metodología AIM)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#construcción-con-ingreso"><i class="fa fa-check"></i><b>4.1</b> Construcción con ingreso</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#a.-cargar-nuestros-datos"><i class="fa fa-check"></i><b>4.1.1</b> <strong>a. cargar nuestros datos</strong></a></li>
<li class="chapter" data-level="4.1.2" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#b.-recodificar-nuestras-variables"><i class="fa fa-check"></i><b>4.1.2</b> <strong>b. recodificar nuestras variables</strong></a></li>
<li class="chapter" data-level="4.1.3" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#c.-integrar-la-variable-gse-y-generar-recodificación"><i class="fa fa-check"></i><b>4.1.3</b> <strong>c. integrar la variable gse y generar recodificación</strong></a></li>
<li class="chapter" data-level="4.1.4" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#d-exportar-bbdd-con-clasificación-socioeconómica"><i class="fa fa-check"></i><b>4.1.4</b> **d) exportar BBDD con clasificación socioeconómica</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#construcción-sin-ingreso-proxy"><i class="fa fa-check"></i><b>4.2</b> Construcción sin ingreso (proxy)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#a.-cargar-nuestros-datos-1"><i class="fa fa-check"></i><b>4.2.1</b> <strong>a. Cargar nuestros datos</strong></a></li>
<li class="chapter" data-level="4.2.2" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#b.-recodificar-nuestras-variables-1"><i class="fa fa-check"></i><b>4.2.2</b> <strong>b. recodificar nuestras variables</strong></a></li>
<li class="chapter" data-level="4.2.3" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#c.-integrar-la-variable-gse-y-generar-recodificación-1"><i class="fa fa-check"></i><b>4.2.3</b> <strong>c. integrar la variable gse y generar recodificación</strong></a></li>
<li class="chapter" data-level="4.2.4" data-path="clasificación-por-nivel-socio-económico-metodología-aim.html"><a href="clasificación-por-nivel-socio-económico-metodología-aim.html#d.-exportar-bbdd-con-clasificación-socioeconómica"><i class="fa fa-check"></i><b>4.2.4</b> <strong>d. exportar BBDD con clasificación socioeconómica</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="malla-de-validación.html"><a href="malla-de-validación.html"><i class="fa fa-check"></i><b>5</b> Malla de validación</a>
<ul>
<li class="chapter" data-level="5.1" data-path="malla-de-validación.html"><a href="malla-de-validación.html#errores-de-valores-perdidos"><i class="fa fa-check"></i><b>5.1</b> Errores de valores perdidos</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="malla-de-validación.html"><a href="malla-de-validación.html#a-selección-de-id-y-variables-de-interés"><i class="fa fa-check"></i><b>5.1.1</b> a) selección de Id y variables de interés</a></li>
<li class="chapter" data-level="5.1.2" data-path="malla-de-validación.html"><a href="malla-de-validación.html#b-casos-perdidos-por-fila-y-columnas"><i class="fa fa-check"></i><b>5.1.2</b> b) casos perdidos por fila y columnas</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="malla-de-validación.html"><a href="malla-de-validación.html#errores-de-programación"><i class="fa fa-check"></i><b>5.2</b> Errores de programación</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="malla-de-validación.html"><a href="malla-de-validación.html#a-creación-de-excel-y-criterios-de-salto"><i class="fa fa-check"></i><b>5.2.1</b> a) creación de excel y criterios de salto</a></li>
<li class="chapter" data-level="5.2.2" data-path="malla-de-validación.html"><a href="malla-de-validación.html#b-aplicación-del-loop"><i class="fa fa-check"></i><b>5.2.2</b> b) aplicación del loop</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="malla-de-validación.html"><a href="malla-de-validación.html#errores-de-consistencia"><i class="fa fa-check"></i><b>5.3</b> Errores de consistencia</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html"><i class="fa fa-check"></i><b>6</b> Construcción de ponderadores por Raking</a>
<ul>
<li class="chapter" data-level="6.1" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#cargar-bases-de-datos-necesarias"><i class="fa fa-check"></i><b>6.1</b> Cargar bases de datos necesarias</a></li>
<li class="chapter" data-level="6.2" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#chequeo-de-variables"><i class="fa fa-check"></i><b>6.2</b> Chequeo de variables</a></li>
<li class="chapter" data-level="6.3" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#recodificaciones"><i class="fa fa-check"></i><b>6.3</b> Recodificaciones</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#recodificación-de-variables-en-bbdd-de-estudio"><i class="fa fa-check"></i><b>6.3.1</b> Recodificación de variables en BBDD de estudio</a></li>
<li class="chapter" data-level="6.3.2" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#recodificaciones-en-bbdd-de-proyecciones-pobalcionales"><i class="fa fa-check"></i><b>6.3.2</b> Recodificaciones en BBDD de proyecciones pobalcionales</a></li>
<li class="chapter" data-level="6.3.3" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#proyecciones-poblacionales-mayores-a-18-años"><i class="fa fa-check"></i><b>6.3.3</b> Proyecciones poblacionales mayores a 18 años</a></li>
<li class="chapter" data-level="6.3.4" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#recodificación-bbdd-casen-2020"><i class="fa fa-check"></i><b>6.3.4</b> Recodificación BBDD Casen 2020</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#construcción-del-ponderador"><i class="fa fa-check"></i><b>6.4</b> Construcción del ponderador</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#creación-de-un-objeto-sin-pesos"><i class="fa fa-check"></i><b>6.4.1</b> <em>Creación de un objeto sin pesos</em></a></li>
<li class="chapter" data-level="6.4.2" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#crear-las-distribuciones-marginales-poblacionales-de-cada-variable-a-utilizar-para-ponderar"><i class="fa fa-check"></i><b>6.4.2</b> <em>Crear las distribuciones marginales poblacionales de cada variable a utilizar para ponderar</em></a></li>
<li class="chapter" data-level="6.4.3" data-path="construcción-de-ponderadores-por-raking.html"><a href="construcción-de-ponderadores-por-raking.html#cáluclo-del-ponderador"><i class="fa fa-check"></i><b>6.4.3</b> <em>Cáluclo del ponderador</em></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bookdown D&amp;A</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number"> 3</span> Automatización de tabulaciones de variables (de frecuencia, contingencia y diferencia de medias)<a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="tablas-de-frecuenciacontingencia" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Tablas de frecuencia/contingencia<a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#tablas-de-frecuenciacontingencia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Gran parte del trabajo que realiza el analista es manipular y presentar datos cualitativos. Debido a esta frecuencia en el uso de estas técnicas, es mucho más eficiente contar con una herramienta (en este caso un script) que nos permita automatizar el proceso de generación de tablas.</p>
<p>Para lograr generar estas tablas realizaremos los siguientes pasos:</p>
<div id="cargar-nuestra-bbdd" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> <strong>1. Cargar nuestra BBDD</strong><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cargar-nuestra-bbdd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargamos nuestra bbdd en formato .sav con la librería haven</span></span>
<span id="cb83-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb83-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir directorio propio (quitar comentario)</span></span>
<span id="cb83-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># getwd()</span></span>
<span id="cb83-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORTAR BBDD</span></span>
<span id="cb83-8"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb83-8" aria-hidden="true" tabindex="-1"></a>director <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;BBDD/220244 BDD_director_escalas.sav&quot;</span>)  <span class="co"># cargar base</span></span>
<span id="cb83-9"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(director<span class="sc">$</span>Pond_Nac)      <span class="co"># resumen estadístico del ponderador (si aplica)</span></span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.7903  0.7903  0.7903  1.0000  1.3146  1.3146</code></pre>
</div>
<div id="creamos-un-banner" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> <strong>2. Creamos un banner</strong><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creamos-un-banner" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se debe crear el objeto Banner, con las variables de cruce a considerar y la función total(). Con el argumento “tab_weight” se pone la variable ponderador.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargamos el tidyverse, pues utilizaremos el pipeline ( %&gt;% )</span></span>
<span id="cb85-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb85-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cargamos la libraría expss</span></span>
<span id="cb85-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span>
<span id="cb85-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co"># duplicamos la base original</span></span>
<span id="cb85-9"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-9" aria-hidden="true" tabindex="-1"></a>BBDD <span class="ot">&lt;-</span> director</span>
<span id="cb85-10"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co"># banner</span></span>
<span id="cb85-12"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-12" aria-hidden="true" tabindex="-1"></a>banner_1 <span class="ot">&lt;-</span> BBDD <span class="sc">%&gt;%</span>     <span class="co"># base</span></span>
<span id="cb85-13"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cols</span>(<span class="fu">total</span>()) <span class="sc">%&gt;%</span>  <span class="co"># variables que queremos como columnas***</span></span>
<span id="cb85-14"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_weight</span>(<span class="at">weight =</span> Pond_Nac)  <span class="co"># agregamos el ponderador de nuestra base</span></span>
<span id="cb85-15"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co"># *** tenemos la posibilidad de agregar otras variables de interés.</span></span>
<span id="cb85-17"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Un ejemplo puede ser incluir la variable &quot;sexo&quot;, u otra variable (ahora solo pediremos el total)</span></span>
<span id="cb85-18"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo:</span></span>
<span id="cb85-19"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="co"># banner_1 &lt;- BBDD %&gt;%                 # base</span></span>
<span id="cb85-20"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_cols(total(c(sexo, comuna)) %&gt;%  # variables que queremos como columnas</span></span>
<span id="cb85-21"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="co"># tab_weight(weight = Pond_Nac)     # agregamos el ponderador de nuestra base</span></span>
<span id="cb85-22"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-23"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-24"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-25"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Si no hay ponderador, se puede usar tambien la función &quot;calc&quot;. </span></span>
<span id="cb85-26"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Hace lo mismo que la otra, pero sin ponderar.</span></span>
<span id="cb85-27"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-27" aria-hidden="true" tabindex="-1"></a><span class="co"># (quitar comentari en caso de utilizar)</span></span>
<span id="cb85-28"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb85-28" aria-hidden="true" tabindex="-1"></a><span class="co">#banner_1 &lt;- calc(total(), estrato_ciudad, V_1, V_2)) </span></span></code></pre></div>
</div>
<div id="una-vez-creamos-nuestro-objeto-banner-debemos-crear-una-función-capaz-de-crear-las-diferencias-proporcionales" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> <strong>3. Una vez creamos nuestro objeto banner, debemos crear una función capaz de crear las diferencias proporcionales</strong><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#una-vez-creamos-nuestro-objeto-banner-debemos-crear-una-función-capaz-de-crear-las-diferencias-proporcionales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># esta función se guardará en nuestro enviroment con el nombre de &quot;tab_pct_sig&quot;</span></span>
<span id="cb86-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb86-2" aria-hidden="true" tabindex="-1"></a>tab_pct_sig <span class="ot">=</span> . <span class="sc">%&gt;%</span> <span class="fu">tab_stat_cpct</span>(                 <span class="co"># funcion</span></span>
<span id="cb86-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_statistic =</span> <span class="fu">c</span>(<span class="st">&quot;w_cases&quot;</span>,                   <span class="co"># total de casos ponderados</span></span>
<span id="cb86-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb86-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;u_cases&quot;</span>),                  <span class="co"># total de casos no poderados</span></span>
<span id="cb86-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_label =</span> <span class="fu">c</span>(<span class="st">&quot;Número de casos ponderados&quot;</span>,    <span class="co"># etiqueta de &quot;w_cases&quot;</span></span>
<span id="cb86-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb86-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Número de casos no ponderados&quot;</span>) <span class="co"># etiqueta de &quot;u_cases&quot;</span></span>
<span id="cb86-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb86-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb86-8"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_last_sig_cpct</span>(<span class="at">bonferroni =</span> <span class="cn">TRUE</span>)             <span class="co"># TRUE=calcula las </span></span>
<span id="cb86-9"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb86-9" aria-hidden="true" tabindex="-1"></a>                                                   <span class="co"># diferencias proporcionales</span></span></code></pre></div>
</div>
<div id="creación-de-secciones-recomendado" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> <strong>4. Creación de secciones (Recomendado)</strong><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creación-de-secciones-recomendado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cuando necesitamos generar múltiples tablas es mejor separar la base de datos por secciones, pues calcular múltiples tablas de diversas variables puede hacer que el computador se congele.</p>
<p>Para este caso crearemos una sección que contiene veintiún preguntas escalares, la cual guardaremos en formato lista. Si lo deseamos, podemos guardar esa lista en otro objeto particular que haga referencia a ella.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creamos nuestra seccion con las preguntas que la componen</span></span>
<span id="cb87-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># para este caso seleccionamos 21 preguntas</span></span>
<span id="cb87-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb87-3" aria-hidden="true" tabindex="-1"></a>seccion_1_prop <span class="ot">&lt;-</span> BBDD <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ConfDir_P1<span class="sc">:</span>ConfProc_P21)</span>
<span id="cb87-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co"># corroboramos que la seccion se componga con las variables requeridas</span></span>
<span id="cb87-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(seccion_1_prop)</span></code></pre></div>
<pre><code>##  [1] &quot;ConfDir_P1&quot;   &quot;ConfDir_P2&quot;   &quot;ConfDir_P3&quot;   &quot;ConfDir_P4&quot;  
##  [5] &quot;ConfDir_P5&quot;   &quot;ConfDir_P6&quot;   &quot;ConfDir_P7&quot;   &quot;ConfDir_P8&quot;  
##  [9] &quot;ConfDir_P9&quot;   &quot;ConfDir_P10&quot;  &quot;ConfDir_P11&quot;  &quot;ConfDir_P12&quot; 
## [13] &quot;ConfDir_P13&quot;  &quot;ConfDir_P14&quot;  &quot;ConfDir_P15&quot;  &quot;ConfDir_P16&quot; 
## [17] &quot;ConfDir_P17&quot;  &quot;ConfDir_P18&quot;  &quot;ConfDir_P19&quot;  &quot;ConfDir_P20&quot; 
## [21] &quot;ConfProc_P21&quot;</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creamos una lista que contiene los elementos solicitados ()</span></span>
<span id="cb89-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-2" aria-hidden="true" tabindex="-1"></a>list_table_seccion1_banner1 <span class="ot">=</span> <span class="fu">lapply</span>(seccion_1_prop, <span class="cf">function</span>(variable) {</span>
<span id="cb89-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  banner_1 <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_cells</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-5" aria-hidden="true" tabindex="-1"></a>    tab_pct_sig <span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_pivot</span>()</span>
<span id="cb89-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb89-8"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Funcion &quot;lapply&quot;: aplica una funcion especifica a cada elemento</span></span>
<span id="cb89-9"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  del objeto que se le indique. Para este caso, aplicamos los tabulados</span></span>
<span id="cb89-10"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   de frecuencias a toda la seccion_1_prop, arrojando un objeto en formato lista</span></span>
<span id="cb89-11"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-12"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Si queremos podemos guardar todas las tablas dentro de un objeto</span></span>
<span id="cb89-15"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="co">#ConfDir_P1 &lt;- list_table_seccion1_banner1$ConfDir_P1</span></span>
<span id="cb89-16"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="do">### OJO: Esta opcion hace que se pierdan las etiquetas </span><span class="al">###</span></span>
<span id="cb89-17"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-18"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-18" aria-hidden="true" tabindex="-1"></a><span class="co"># codigo para obtener un ejemplo de nuestras tablas (para P1 en este caso)</span></span>
<span id="cb89-19"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb89-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(list_table_seccion1_banner1<span class="sc">$</span>ConfDir_P1)</span></code></pre></div>
<pre><code>##                                                                                                                                                                                                                                                                    
##  |                                                                                                                                                                                                                                                                |
##  | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
##  | P1_01 A continuación, se enuncian una serie de AFIRMACIONES SOBRE DISTINTOS ESTAMENTOS DE ESTE LICEO, Por favor, marque su nivel de acuerdo o desacuerdo con cada afirmación, considerando que 1 es Muy en desacuerdo y 6 es Muy de acuerdo:Los docentes de es |
##  |                                                                                                                                                                                                                                                                |
##  |                                                                                                                                                                                                                                                                |
##  |                                                                                                                                                                                                                                                                |
##  |                                                                                                                                                                                                                                                                |
##  |                                                                                                                                                                                                                                                                |
##  |                                                                                                                                                                                                                                                                |
##  |                                                                                                                                                                                                                                                                |
##  |                                                                                                                                                                                                                                                                |
##                                           
##                                 | #Total |
##  ------------------------------ | ------ |
##               Muy en desacuerdo |        |
##                               2 |        |
##                               3 |    1.6 |
##                               4 |   28.4 |
##                               5 |   49.5 |
##                  Muy de acuerdo |   17.9 |
##                              NR |    2.6 |
##     #Número de casos ponderados |     50 |
##  #Número de casos no ponderados |     50 |</code></pre>
<hr />
</div>
</div>
<div id="tablas-de-diferencias-de-medias" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Tablas de diferencias de medias<a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#tablas-de-diferencias-de-medias" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Así como buscamos crear tablas de frecuencias/contingencias, también necesitaremos crear tablas que contengan datos cuantitativos. Para este caso haremos tablas con diferencias de medias.</p>
<div id="creamos-un-banner-1" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> <strong>1. Creamos un banner</strong><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creamos-un-banner-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creamos un banner que contenga nuestra informacion</span></span>
<span id="cb91-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># duplicamos la base original</span></span>
<span id="cb91-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-4" aria-hidden="true" tabindex="-1"></a>BBDD <span class="ot">&lt;-</span> director</span>
<span id="cb91-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co"># banner</span></span>
<span id="cb91-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-7" aria-hidden="true" tabindex="-1"></a>banner_2 <span class="ot">&lt;-</span> BBDD <span class="sc">%&gt;%</span>             <span class="co"># base</span></span>
<span id="cb91-8"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_cols</span>(<span class="fu">total</span>()) <span class="sc">%&gt;%</span>    <span class="co"># variables que queremos como columnas***</span></span>
<span id="cb91-9"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_weight</span>(<span class="at">weight =</span> Pond_Nac)  <span class="co"># agregamos el ponderador de nuestra base</span></span>
<span id="cb91-10"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># *** tenemos la posibilidad de agregar otras variables de interés.</span></span>
<span id="cb91-12"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  Un ejemplo puede ser incluir la variable &quot;sexo&quot;, u otra variable</span></span>
<span id="cb91-13"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo:</span></span>
<span id="cb91-14"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co"># banner_1 &lt;- BBDD %&gt;%                 # base</span></span>
<span id="cb91-15"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_cols(total(c(sexo, comuna)) %&gt;%  # variables que queremos como columnas</span></span>
<span id="cb91-16"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_weight(weight = Pond_Nac)     # agregamos el ponderador de nuestra base</span></span>
<span id="cb91-17"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Si no hay ponderador, se puede usar tambien la función &quot;calc&quot;. </span></span>
<span id="cb91-20"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Hace lo mismo que la otra, pero sin ponderar</span></span>
<span id="cb91-21"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="co"># banner_1 &lt;- calc(total(), estrato_ciudad, V_1, V_2)) </span></span></code></pre></div>
</div>
<div id="creamos-una-función-que-nos-permita-calcular-las-diferencias-de-medias" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> <strong>2. Creamos una función que nos permita calcular las diferencias de medias</strong><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creamos-una-función-que-nos-permita-calcular-las-diferencias-de-medias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># esta función se guardará en nuestro enviroment con el nombre de &quot;tab_means_sig&quot;</span></span>
<span id="cb92-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb92-2" aria-hidden="true" tabindex="-1"></a>tab_means_sig <span class="ot">=</span> . <span class="sc">%&gt;%</span> <span class="fu">tab_stat_mean_sd_n</span>(   <span class="co"># funcion</span></span>
<span id="cb92-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Mean&quot;</span>,                        <span class="co"># etiquetas que tendran las filas.</span></span>
<span id="cb92-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb92-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;sd&quot;</span>,                          <span class="co"># Siguen el mismo orden que la funcion:</span></span>
<span id="cb92-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb92-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;N&quot;</span>)) <span class="sc">%&gt;%</span>                      <span class="co"># mean, sd, n</span></span>
<span id="cb92-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_last_sig_means</span>(<span class="at">bonferroni =</span> <span class="cn">TRUE</span>)     <span class="co"># TRUE=calcula las diferencias de media</span></span></code></pre></div>
</div>
<div id="creación-de-secciones-recomendado-1" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> <strong>3. Creación de secciones (Recomendado)</strong><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#creación-de-secciones-recomendado-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cuando necesitamos generar múltiples tablas es mejor separar la base de datos por secciones, pues calcular múltiples tablas de diversas variables puede hacer que el computador se congele.</p>
<p>Para este caso crearemos una sección que contiene veintiún preguntas escalares, la cual guardaremos en formato lista. Si lo deseamos, podemos guardar esa lista en otro objeto particular que haga referencia a ella.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creamos nuestra seccion con las preguntas que la componen</span></span>
<span id="cb93-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb93-2" aria-hidden="true" tabindex="-1"></a>seccion_1_medias <span class="ot">&lt;-</span> BBDD <span class="sc">%&gt;%</span> </span>
<span id="cb93-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ConfDir_P1<span class="sc">:</span>ConfProc_P21)</span>
<span id="cb93-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co"># corroboramos que la seccion se componga con las variables requeridas</span></span>
<span id="cb93-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(seccion_1_medias) </span></code></pre></div>
<pre><code>##  [1] &quot;ConfDir_P1&quot;   &quot;ConfDir_P2&quot;   &quot;ConfDir_P3&quot;   &quot;ConfDir_P4&quot;  
##  [5] &quot;ConfDir_P5&quot;   &quot;ConfDir_P6&quot;   &quot;ConfDir_P7&quot;   &quot;ConfDir_P8&quot;  
##  [9] &quot;ConfDir_P9&quot;   &quot;ConfDir_P10&quot;  &quot;ConfDir_P11&quot;  &quot;ConfDir_P12&quot; 
## [13] &quot;ConfDir_P13&quot;  &quot;ConfDir_P14&quot;  &quot;ConfDir_P15&quot;  &quot;ConfDir_P16&quot; 
## [17] &quot;ConfDir_P17&quot;  &quot;ConfDir_P18&quot;  &quot;ConfDir_P19&quot;  &quot;ConfDir_P20&quot; 
## [21] &quot;ConfProc_P21&quot;</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creamos una lista que contiene los elementos solicitados ()</span></span>
<span id="cb95-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-2" aria-hidden="true" tabindex="-1"></a>list_table_seccion1_banner2 <span class="ot">=</span> <span class="fu">lapply</span>(seccion_1_medias, <span class="cf">function</span>(variable) {</span>
<span id="cb95-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  banner_2 <span class="sc">%&gt;%</span> </span>
<span id="cb95-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_cells</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_means_sig</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_pivot</span>()</span>
<span id="cb95-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb95-8"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Funcion &quot;lapply&quot;: aplica una operacion especifica a cada elemento</span></span>
<span id="cb95-9"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  del objeto que se le indique. Para este caso, aplicamos los tabulados</span></span>
<span id="cb95-10"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   de media a toda la seccion_1_medias, arrojando un objeto en formato lista</span></span>
<span id="cb95-11"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-13"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Si queremos podemos guardar todas las tablas dentro de un objeto</span></span>
<span id="cb95-14"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="co">#ConfDir_P1 &lt;- list_table_seccion1_banner2$ConfDir_P1</span></span>
<span id="cb95-15"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Esta opcion hace que se pierdan las etiquetas</span></span>
<span id="cb95-16"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-17"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="co"># codigo para obtener un ejemplo de nuestras tablas (para P1 en este caso)</span></span>
<span id="cb95-18"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb95-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(list_table_seccion1_banner2<span class="sc">$</span>ConfDir_P1)</span></code></pre></div>
<pre><code>##                                                                                                                                                                                                                                                                    
##  |                                                                                                                                                                                                                                                                |
##  | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
##  | P1_01 A continuación, se enuncian una serie de AFIRMACIONES SOBRE DISTINTOS ESTAMENTOS DE ESTE LICEO, Por favor, marque su nivel de acuerdo o desacuerdo con cada afirmación, considerando que 1 es Muy en desacuerdo y 6 es Muy de acuerdo:Los docentes de es |
##  |                                                                                                                                                                                                                                                                |
##  |                                                                                                                                                                                                                                                                |
##                 
##       | #Total |
##  ---- | ------ |
##  Mean |    7.3 |
##    sd |   15.2 |
##     N |   50.0 |</code></pre>
<hr />
</div>
</div>
<div id="exportar-tablas-a-excel" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Exportar tablas a excel<a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#exportar-tablas-a-excel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Una vez tengamos los cálculos de nuestras tablas, necesitaremos exportarlas para poder presentarlas de buena manera. Contamos con dos alternativas para esto: 1) exportarlas de manera independiente o 2) exportar ambas tablas (de frecuencias y de diferencias de medias) en un solo archivo excel.</p>
<div id="independientes-porcentajes" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> 1. Independientes: porcentajes<a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#independientes-porcentajes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>a) Construir hoja de cálculo en R</strong></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># para construir nuestro hoja de calculo de R utilizaremos la libreria &quot;openxlsx&quot;</span></span>
<span id="cb97-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb97-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crear excel en R</span></span>
<span id="cb97-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb97-5" aria-hidden="true" tabindex="-1"></a>banner_prop <span class="ot">=</span> <span class="fu">createWorkbook</span>()  <span class="co"># generamos documento en blanco.</span></span>
<span id="cb97-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb97-6" aria-hidden="true" tabindex="-1"></a>sh1 <span class="ot">=</span> <span class="fu">addWorksheet</span>(             <span class="co"># generamos una hoja para las diferencias de</span></span>
<span id="cb97-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb97-7" aria-hidden="true" tabindex="-1"></a>  banner_prop, <span class="st">&quot;Proporciones&quot;</span>)  <span class="co"># proporciones</span></span></code></pre></div>
<p><strong>b) Introducir elementos al objeto woorkbook</strong></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># para introducir elementos dentro de nuesto objeto excel generado utilizamos la libreria &quot;expss&quot;</span></span>
<span id="cb98-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span>
<span id="cb98-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xl_write</span>(list_table_seccion1_banner1,   <span class="co"># lista con nuestros resultados la seccion 1</span></span>
<span id="cb98-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb98-5" aria-hidden="true" tabindex="-1"></a>         banner_prop,                   <span class="co"># nuestro objeto workbook creado anteriormente</span></span>
<span id="cb98-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb98-6" aria-hidden="true" tabindex="-1"></a>         sh1,                           <span class="co"># hoja especifica para proporciones</span></span>
<span id="cb98-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb98-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">col_symbols_to_remove =</span> <span class="st">&quot;#&quot;</span>,   <span class="co"># eilimanr # de las columnas</span></span>
<span id="cb98-8"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb98-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">row_symbols_to_remove =</span> <span class="st">&quot;#&quot;</span>,   <span class="co"># eliminar # de las filas</span></span>
<span id="cb98-9"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb98-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">other_col_labels_formats =</span> <span class="fu">list</span>(<span class="st">&quot;#&quot;</span> <span class="ot">=</span> <span class="fu">createStyle</span>(<span class="at">textDecoration =</span> <span class="st">&quot;bold&quot;</span>)))</span></code></pre></div>
<p><strong>c) Exportar objeto workbook a excel</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exportar todo lo introducido en banner_prop a excel</span></span>
<span id="cb99-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="do">### OJO: quitar comentarios para usar </span><span class="al">###</span></span>
<span id="cb99-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWorkbook(banner_prop,                        # objeto a exportar</span></span>
<span id="cb99-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co">#              &quot;Diferencias proporcionales.xlsx&quot;,  # nombre de la hoja</span></span>
<span id="cb99-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co">#              overwrite = TRUE)</span></span></code></pre></div>
<p><img src="Imagenes/dif_prop.png" /></p>
</div>
<div id="independientes-diferencia-de-medias" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> 2. Independientes: diferencia de medias<a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#independientes-diferencia-de-medias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>a) Construir hoja de cálculo en R</strong></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># para construir nuestro hoja de calculo de R utilizaremos la libreria &quot;openxlsx&quot;</span></span>
<span id="cb100-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb100-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crear excel en R</span></span>
<span id="cb100-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb100-5" aria-hidden="true" tabindex="-1"></a>banner_medias <span class="ot">=</span> <span class="fu">createWorkbook</span>()           <span class="co"># generamos documento en blanco</span></span>
<span id="cb100-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb100-6" aria-hidden="true" tabindex="-1"></a>sh2 <span class="ot">=</span> <span class="fu">addWorksheet</span>(banner_medias,          <span class="co"># generamos una hoja para</span></span>
<span id="cb100-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb100-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Diferencias de media&quot;</span>) <span class="co"># insertar las medias</span></span></code></pre></div>
<p><strong>b) Introducir elementos al objeto woorkbook</strong></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># para introducir elementos dentro de nuesto objeto excel generado utilizamos la libreria &quot;expss&quot;</span></span>
<span id="cb101-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span>
<span id="cb101-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xl_write</span>(list_table_seccion1_banner2,  <span class="co"># lista con nuestros resultados la seccion 1</span></span>
<span id="cb101-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb101-5" aria-hidden="true" tabindex="-1"></a>         banner_medias,             <span class="co"># nuestro objeto workbook creado anteriormente</span></span>
<span id="cb101-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb101-6" aria-hidden="true" tabindex="-1"></a>         sh1,                             <span class="co"># hoja especifica para docentes</span></span>
<span id="cb101-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb101-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">col_symbols_to_remove =</span> <span class="st">&quot;#&quot;</span>,     <span class="co"># eiliminar # de las columnas</span></span>
<span id="cb101-8"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb101-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">row_symbols_to_remove =</span> <span class="st">&quot;#&quot;</span>,     <span class="co"># eliminar # de las filas</span></span>
<span id="cb101-9"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb101-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">other_col_labels_formats =</span> <span class="fu">list</span>(<span class="st">&quot;#&quot;</span> <span class="ot">=</span> <span class="fu">createStyle</span>(<span class="at">textDecoration =</span> <span class="st">&quot;bold&quot;</span>)))</span></code></pre></div>
<p><strong>c) Exportar objeto workbook a excel</strong></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # exportar todo lo introducido en banner_prop a excel</span></span>
<span id="cb102-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="do">### OJO: quitar comentarios para usar </span><span class="al">###</span></span>
<span id="cb102-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWorkbook(banner_medias,               # objeto a exportar</span></span>
<span id="cb102-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co">#              &quot;Diferencias de medias.xlsx&quot;,  # nombre de la hoja</span></span>
<span id="cb102-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co">#              overwrite = TRUE)</span></span></code></pre></div>
<p><img src="Imagenes/dif_med.png" /></p>
</div>
<div id="en-conjunto-porcentaje-y-dif-de-medias-en-un-solo-archivo" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> 3. En conjunto: porcentaje y dif de medias en un solo archivo<a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#en-conjunto-porcentaje-y-dif-de-medias-en-un-solo-archivo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para exportar un solo archivo excel debemos:</p>
<p><strong>a) Crear banner con sus hojas</strong></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crear banner</span></span>
<span id="cb103-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb103-2" aria-hidden="true" tabindex="-1"></a>banner_full <span class="ot">&lt;-</span> <span class="fu">createWorkbook</span>()  <span class="co"># generamos documento en blanco</span></span>
<span id="cb103-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb103-3" aria-hidden="true" tabindex="-1"></a>sh3 <span class="ot">&lt;-</span> <span class="fu">addWorksheet</span>(banner_full, <span class="co"># generamos una hoja para insertar las proporciones</span></span>
<span id="cb103-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb103-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Diferencias proporcionales&quot;</span>)</span>
<span id="cb103-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb103-5" aria-hidden="true" tabindex="-1"></a>sh4 <span class="ot">&lt;-</span> <span class="fu">addWorksheet</span>(banner_full,</span>
<span id="cb103-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb103-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Diferencias de medias&quot;</span>)  <span class="co"># generamos una hoja para insertar las medias</span></span></code></pre></div>
<p><strong>b) Escribir información dentro del objeto workbook</strong></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># para introducir elementos dentro de nuesto objeto excel generado </span></span>
<span id="cb104-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># utilizamos la libreria &quot;expss&quot;</span></span>
<span id="cb104-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span>
<span id="cb104-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">xl_write</span>(list_table_seccion1_banner2,          <span class="co"># lista con nuestros resultados la seccion 1</span></span>
<span id="cb104-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-6" aria-hidden="true" tabindex="-1"></a>         banner_full,                          <span class="co"># nuestro objeto workbook creado anteriormente</span></span>
<span id="cb104-7"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-7" aria-hidden="true" tabindex="-1"></a>         sh4,                                  <span class="co"># hoja especifica para medias</span></span>
<span id="cb104-8"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">col_symbols_to_remove =</span> <span class="st">&quot;#&quot;</span>,          <span class="co"># eilimanr # de las columnas</span></span>
<span id="cb104-9"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">row_symbols_to_remove =</span> <span class="st">&quot;#&quot;</span>,          <span class="co"># eliminar # de las filas</span></span>
<span id="cb104-10"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">other_col_labels_formats =</span> <span class="fu">list</span>(<span class="st">&quot;#&quot;</span> <span class="ot">=</span> <span class="fu">createStyle</span>(<span class="at">textDecoration =</span> <span class="st">&quot;bold&quot;</span>)))</span>
<span id="cb104-11"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-12"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="fu">xl_write</span>(list_table_seccion1_banner1,          <span class="co"># lista con nuestros resultados la seccion 1</span></span>
<span id="cb104-13"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-13" aria-hidden="true" tabindex="-1"></a>         banner_full,                          <span class="co"># nuestro objeto workbook creado anteriormente</span></span>
<span id="cb104-14"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-14" aria-hidden="true" tabindex="-1"></a>         sh3,                                  <span class="co"># hoja especifica para proporciones</span></span>
<span id="cb104-15"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">col_symbols_to_remove =</span> <span class="st">&quot;#&quot;</span>,          <span class="co"># eilimanr # de las columnas</span></span>
<span id="cb104-16"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">row_symbols_to_remove =</span> <span class="st">&quot;#&quot;</span>,          <span class="co"># eliminar # de las filas</span></span>
<span id="cb104-17"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb104-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">other_col_labels_formats =</span> <span class="fu">list</span>(<span class="st">&quot;#&quot;</span> <span class="ot">=</span> <span class="fu">createStyle</span>(<span class="at">textDecoration =</span> <span class="st">&quot;bold&quot;</span>)))</span></code></pre></div>
<p><strong>c) Exportar archivo excel</strong></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exportar todo lo introducido en banner_prop a excel</span></span>
<span id="cb105-2"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="do">### OJO: quitar comentarios para usar </span><span class="al">###</span></span>
<span id="cb105-4"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWorkbook(banner_full,                       # objeto a exportar</span></span>
<span id="cb105-5"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co">#              &quot;Diferencias prop y medias.xlsx&quot;,  # nombre de la hoja</span></span>
<span id="cb105-6"><a href="automatización-de-tabulaciones-de-variables-de-frecuencia-contingencia-y-diferencia-de-medias.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co">#              overwrite = TRUE)</span></span></code></pre></div>
<p><strong>Al exportar nuestro archivo, nos encontraremos dos hojas dentro del mismo archivo excel, una para cada sheet que hayamos agregado en nuestro código de R (en este caso sh3 y sh4 presentes en el código anterior)</strong></p>
<p><img src="Imagenes/dif_prop_med.png" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="procesamiento-de-base-de-datos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="clasificación-por-nivel-socio-económico-metodología-aim.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Jona-S99/Bookdown/edit/master/03-Auto_tabulaciones.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Jona-S99/Bookdown/blob/master/03-Auto_tabulaciones.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
